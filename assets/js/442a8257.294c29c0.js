"use strict";(self.webpackChunkcf_infra_docs=self.webpackChunkcf_infra_docs||[]).push([[79354],{16032:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"how-to/advanced/enable-archs","title":"How to enable additional architectures","description":"By default, feedstocks are created with support for the main platforms (e.g. linux-64, osx-64, win-64). Additional ones may be available in an opt-in fashion. The configuration can be changed manually in conda-forge.yml, or through automated migrations.","source":"@site/docs/how-to/advanced/enable-archs.md","sourceDirName":"how-to/advanced","slug":"/how-to/advanced/enable-archs","permalink":"/docs/how-to/advanced/enable-archs","draft":false,"unlisted":false,"editUrl":"https://github.com/conda-forge/conda-forge.github.io/tree/refs/heads/main/docs/how-to/advanced/enable-archs.md","tags":[{"inline":true,"label":"how-to","permalink":"/docs/tags/how-to"},{"inline":true,"label":"advanced","permalink":"/docs/tags/advanced"}],"version":"current","lastUpdatedAt":1765802822000,"frontMatter":{"tags":["how-to","advanced"]},"sidebar":"diataxis","previous":{"title":"Advanced","permalink":"/docs/how-to/advanced"},"next":{"title":"Talk to the bots","permalink":"/docs/how-to/advanced/talk-to-the-bots"}}');var r=i(74848),t=i(28453);const o={tags:["how-to","advanced"]},s="How to enable additional architectures",c={},d=[{value:"Automated migrations",id:"automated-migrations",level:2},{value:"General steps",id:"general-steps",level:3},{value:"Architecture-specific information",id:"architecture-specific-information",level:3},{value:"Enable osx-arm64",id:"enable-osx-arm64",level:3},{value:"Enable linux-aarch64 and linux-ppc64le",id:"enable-linux-aarch64-and-linux-ppc64le",level:3},{value:"Enable win-arm64",id:"enable-win-arm64",level:3},{value:"Manual migrations",id:"manual-migrations",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"how-to-enable-additional-architectures",children:"How to enable additional architectures"})}),"\n",(0,r.jsxs)(n.p,{children:["By default, feedstocks are created with support for the main platforms (e.g. ",(0,r.jsx)(n.code,{children:"linux-64"}),", ",(0,r.jsx)(n.code,{children:"osx-64"}),", ",(0,r.jsx)(n.code,{children:"win-64"}),"). Additional ones may be available in an opt-in fashion. The configuration can be changed ",(0,r.jsx)(n.a,{href:"#manual-migrations",children:"manually"})," in ",(0,r.jsx)(n.code,{children:"conda-forge.yml"}),", or through ",(0,r.jsx)(n.a,{href:"#automated-migrations",children:"automated migrations"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"automated-migrations",children:"Automated migrations"}),"\n",(0,r.jsxs)(n.p,{children:["New architectures can be added by changing the default configuration in ",(0,r.jsx)(n.code,{children:"conda-forge.yml"})," and rerendering. However, since building a new architecture requires that your dependencies are also available for that architecture, this is usually controlled by migrations triggered by changes on specific files available in the ",(0,r.jsx)(n.code,{children:"conda-forge-pinning-feedstock"})," repository."]}),"\n",(0,r.jsx)(n.p,{children:"Before submitting a build request for a new architecure, check whether:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["The package is already built for that architecture. Consult the package page in anaconda.org: ",(0,r.jsx)(n.code,{children:"https://anaconda.org/conda-forge/<package-name>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Your package is already in the process of being migrated in the ",(0,r.jsx)(n.a,{href:"https://conda-forge.org/status/",children:"corresponding migration status page"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"The feedstock in question has already an issue or pull request for that architecture, which may contain information why the package is not yet available."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["If you do see an open PR (or once a PR is submitted by the migration), you can help the feedstock maintainers make the build pass. If you have insight into the particular package, ",(0,r.jsx)(n.strong,{children:"please"})," chime in, but most of all ",(0,r.jsx)(n.strong,{children:"be patient and polite"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Once the new builds are available from ",(0,r.jsx)(n.code,{children:"anaconda.org"}),", please help the maintainers by testing the packages, and reporting back with any problems\u2026 but also successes!"]}),"\n",(0,r.jsx)(n.h3,{id:"general-steps",children:"General steps"}),"\n",(0,r.jsx)(n.p,{children:"Adding a new architecture usually means following the same steps, but targeting different configuration files:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Fork ",(0,r.jsx)(n.code,{children:"conda-forge-pinning-feedstock"})," and create a fresh new branch. See ",(0,r.jsx)(n.a,{href:"/docs/how-to/basics/fork-sync",children:"How to fork your feedstock"})," for more details."]}),"\n",(0,r.jsxs)(n.li,{children:["Edit the migration file for your architecture (see ",(0,r.jsx)(n.a,{href:"#architecture-specific-information",children:"architecture-specific information"}),") to add the name of your feedstock, without the ",(0,r.jsx)(n.code,{children:"-feedstock"})," suffix. Make sure to insert it in the right position to respect alphabetical order, or run ",(0,r.jsx)(n.code,{children:"pre-commit run -a"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Commit the changes, push the branch to your fork (",(0,r.jsx)(n.code,{children:"origin"}),") and open the pull request."]}),"\n",(0,r.jsxs)(n.li,{children:["Wait for a member of ",(0,r.jsx)(n.code,{children:"@conda-forge/core"})," to review and merge your pull request."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Once merged, the feedstock will be added to the corresponding migration, which can be tracked in its status page (see ",(0,r.jsx)(n.a,{href:"#architecture-specific-information",children:"architecture-specific information"})," for the relevant links). When all dependencies are available, the bot will open a new PR with the necessary changes."]}),"\n",(0,r.jsx)(n.h3,{id:"architecture-specific-information",children:"Architecture-specific information"}),"\n",(0,r.jsx)(n.p,{children:"The sections below specify the configuration details for each platform."}),"\n",(0,r.jsx)(n.h3,{id:"enable-osx-arm64",children:"Enable osx-arm64"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Migration file: ",(0,r.jsx)(n.a,{href:"https://github.com/conda-forge/conda-forge-pinning-feedstock/blob/main/recipe/migration_support/osx_arm64.txt",children:(0,r.jsx)(n.code,{children:"osx_arm64.txt"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Status page: ",(0,r.jsx)(n.a,{href:"/status/migration/?name=armosxaddition",children:(0,r.jsx)(n.code,{children:"armosxaddition"})}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Note that this migration involves ",(0,r.jsx)(n.a,{href:"/docs/maintainer/knowledge_base/#cross-compilation",children:"cross-compiled builds"}),", which may get tricky if the build system has not been configured with those options in mind. Emulation is not available on this platform."]}),"\n",(0,r.jsx)(n.h3,{id:"enable-linux-aarch64-and-linux-ppc64le",children:"Enable linux-aarch64 and linux-ppc64le"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Migration file: ",(0,r.jsx)(n.a,{href:"https://github.com/conda-forge/conda-forge-pinning-feedstock/blob/main/recipe/migration_support/arch_rebuild.txt",children:(0,r.jsx)(n.code,{children:"arch_rebuild.txt"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Status page: ",(0,r.jsx)(n.a,{href:"/status/migration/?name=aarch64andppc64leaddition",children:(0,r.jsx)(n.code,{children:"aarch64andppc64leaddition"})}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Note that this migration will enable both architectures in your feedstock. If you only need one, you can push one of these changes to the bot PR:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Remove the corresponding line from ",(0,r.jsx)(n.code,{children:"conda-forge.yml"})," and rerender."]}),"\n",(0,r.jsxs)(n.li,{children:["Add a ",(0,r.jsx)(n.code,{children:"skip:"})," directive to your recipe by matching the non-desired platform, and rerender."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["This migration uses ",(0,r.jsx)(n.a,{href:"/docs/maintainer/knowledge_base/#emulated-builds",children:"emulated builds"})," by default, which are easier to configure but offer far worse performance. ",(0,r.jsx)(n.a,{href:"/docs/maintainer/knowledge_base/#cross-compilation",children:"Cross-compiled builds"})," requires extra configuration steps but it uses resources more efficiently (6-7x faster)."]}),"\n",(0,r.jsxs)(n.p,{children:["To change to cross-compiled builds, use this configuration in ",(0,r.jsx)(n.code,{children:"conda-forge.yml"})," and ",(0,r.jsx)(n.a,{href:"/docs/how-to/basics/rerender",children:"rerender"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"build_platform:\n  linux_aarch64: linux_64\n  linux_ppc64le: linux_64\n"})}),"\n",(0,r.jsx)(n.h3,{id:"enable-win-arm64",children:"Enable win-arm64"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Migration file: ",(0,r.jsx)(n.a,{href:"https://github.com/conda-forge/conda-forge-pinning-feedstock/blob/main/recipe/migration_support/win_arm64.txt",children:(0,r.jsx)(n.code,{children:"win_arm64.txt"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Status page: ",(0,r.jsx)(n.a,{href:"/status/migration/?name=supportwindowsarm64platform",children:(0,r.jsx)(n.code,{children:"supportwindowsarm64platform"})}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"manual-migrations",children:"Manual migrations"}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"Pending."})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>s});var a=i(96540);const r={},t=a.createContext(r);function o(e){const n=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),a.createElement(t.Provider,{value:n},e.children)}}}]);