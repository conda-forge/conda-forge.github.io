"use strict";(self.webpackChunkcf_infra_docs=self.webpackChunkcf_infra_docs||[]).push([[40840],{57463:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>l,frontMatter:()=>r,metadata:()=>a,toc:()=>h});const a=JSON.parse('{"id":"how-to/advanced/several-versions","title":"How to maintain several versions","description":"The conda-forge workflow assumes that a push to any branch in the feedstock repository will result in a build being uploaded to the conda-forge channel (and that\'s why PRs must always be opened from a fork!).","source":"@site/docs/how-to/advanced/several-versions.md","sourceDirName":"how-to/advanced","slug":"/how-to/advanced/several-versions","permalink":"/docs/how-to/advanced/several-versions","draft":false,"unlisted":false,"editUrl":"https://github.com/conda-forge/conda-forge.github.io/tree/refs/heads/main/docs/how-to/advanced/several-versions.md","tags":[{"inline":true,"label":"how-to","permalink":"/docs/tags/how-to"},{"inline":true,"label":"advanced","permalink":"/docs/tags/advanced"}],"version":"current","lastUpdatedAt":1765412020000,"frontMatter":{"tags":["how-to","advanced"]},"sidebar":"diataxis","previous":{"title":"Talk to the bots","permalink":"/docs/how-to/advanced/talk-to-the-bots"},"next":{"title":"Emergencies","permalink":"/docs/how-to/emergencies"}}');var t=s(74848),o=s(28453);const r={tags:["how-to","advanced"]},i="How to maintain several versions",c={},h=[{value:"Create the new branch",id:"create-the-new-branch",level:2},{value:"Open a PR with the necessary changes",id:"open-a-pr-with-the-necessary-changes",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"how-to-maintain-several-versions",children:"How to maintain several versions"})}),"\n",(0,t.jsx)(n.p,{children:"The conda-forge workflow assumes that a push to any branch in the feedstock repository will result in a build being uploaded to the conda-forge channel (and that's why PRs must always be opened from a fork!)."}),"\n",(0,t.jsxs)(n.p,{children:["Most feedstocks only need ",(0,t.jsx)(n.code,{children:"main"})," for their builds, since the package has a single release line, and new releases always imply a later version. However, some packages may maintain a few release lines in parallel. If you wish to maintain those in your feedstock, you will need to create a branch for each."]}),"\n",(0,t.jsx)(n.h2,{id:"create-the-new-branch",children:"Create the new branch"}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"This operation can only be performed by users with write acccess to the feedstock."})}),"\n",(0,t.jsxs)(n.p,{children:["In the local copy of your ",(0,t.jsx)(n.a,{href:"/docs/how-to/basics/fork-sync",children:"forked repository"}),", create a branch named after the release line you want to maintain. For example, for ",(0,t.jsx)(n.code,{children:"3.10"}),", it could be:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"git checkout main\ngit pull upstream main\ngit checkout -b v3.10.x\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Add an empty commit with the ",(0,t.jsx)(n.code,{children:"[ci skip]"})," message so the new branch does not result in a new build process, and push it to ",(0,t.jsx)(n.code,{children:"upstream"}),". This is one of the rare ocassions where you must push directly to the feedstock, not your fork!"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'git commit --allow-empty -m "[ci skip] Create new branch for v3.10.x release series"\ngit push -u upstream v3.10.x\n'})}),"\n",(0,t.jsx)(n.p,{children:"Now, this branch can be selected as a target branch in the following steps."}),"\n",(0,t.jsx)(n.h2,{id:"open-a-pr-with-the-necessary-changes",children:"Open a PR with the necessary changes"}),"\n",(0,t.jsx)(n.p,{children:"From the same branch, create another one to add some extra changes that will need to be reviewed in a PR:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"git checkout -b setup-3.10.x\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Open your ",(0,t.jsx)(n.code,{children:"conda-forge.yml"})," file and add these lines:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'bot:\n  abi_migration_branches:\n    - "v3.10.x"  # or the branch name you picked\n'})}),"\n",(0,t.jsxs)(n.p,{children:["And ",(0,t.jsx)(n.a,{href:"/docs/how-to/basics/rerender",children:"rerender"}),". Now, make sure to adjust the recipe file so the correct version is being built."]}),"\n",(0,t.jsxs)(n.p,{children:["Once ready, push the branch to your fork (",(0,t.jsx)(n.code,{children:"origin"}),") and open the corresponding pull request. Don't forget to pick ",(0,t.jsx)(n.code,{children:"v3.10.x"})," as the target branch!"]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["In some cases, the ",(0,t.jsx)(n.code,{children:"abi_migration_branches"})," may receive migration PRs that have already been processed. This is being looked into at ",(0,t.jsx)(n.a,{href:"https://github.com/regro/cf-scripts/issues/2500",children:"regro/cf-scripts#2500"}),". In the meantime, you can ignore these redundant PRs by closing them."]})})]})}function l(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>i});var a=s(96540);const t={},o=a.createContext(t);function r(e){const n=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),a.createElement(o.Provider,{value:n},e.children)}}}]);