"use strict";(globalThis.webpackChunkcf_infra_docs=globalThis.webpackChunkcf_infra_docs||[]).push([[57873],{11568(e,n,c){c.r(n),c.d(n,{assets:()=>t,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var o=c(2958),s=c(74848),i=c(28453);const r={authors:["isuruf"],tags:["infrastructure"]},a="gcc, g++ builds on macos",t={authorsImageUrls:[void 0]},l=[];function d(e){const n={code:"code",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["On macOS, conda-forge has provided ",(0,s.jsx)(n.code,{children:"clang"}),", ",(0,s.jsx)(n.code,{children:"clangxx"})," as the sole compiler\nfor C and C++ sources. We have also provided ",(0,s.jsx)(n.code,{children:"gfortran"})," to compile FORTRAN\nsources. Unlike other package managers like homebrew we have not\nprovided ",(0,s.jsx)(n.code,{children:"gcc"})," nor ",(0,s.jsx)(n.code,{children:"g++"})," on macos. The reason to not provide those have been\nto avoid incompatibility with the clang based toolchain and also the\nmaintenance burden. There are two main incompatibilities. First,\n",(0,s.jsx)(n.code,{children:"clang++"})," uses ",(0,s.jsx)(n.code,{children:"libc++"})," as the standard C++ library and ",(0,s.jsx)(n.code,{children:"g++"})," uses\n",(0,s.jsx)(n.code,{children:"libstdc++"})," as the standard C++ library. Second, ",(0,s.jsx)(n.code,{children:"clang"})," uses ",(0,s.jsx)(n.code,{children:"libomp"}),"\nas the OpenMP library whereas ",(0,s.jsx)(n.code,{children:"gcc"})," uses ",(0,s.jsx)(n.code,{children:"libgomp"})," as the OpenMP library."]}),"\n",(0,s.jsxs)(n.p,{children:["Today, we announce the availability of ",(0,s.jsx)(n.code,{children:"gcc"}),", ",(0,s.jsx)(n.code,{children:"g++"})," compilers on macos.\nYou can install them using:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"conda install gcc gxx\n"})}),"\n",(0,s.jsx)(n.p,{children:"Currently we support only gcc 15 and will not support gcc 14 or previous\nversions."}),"\n",(0,s.jsxs)(n.p,{children:["The main difference between these packages and a vanilla gcc installation\nor the installation from Homebew is that they use ",(0,s.jsx)(n.code,{children:"libomp"})," as the default\nOpenMP library and ",(0,s.jsx)(n.code,{children:"libc++"})," as the default standard C++ library.\nThis difference makes binaries compiled with ",(0,s.jsx)(n.code,{children:"gcc"}),", ",(0,s.jsx)(n.code,{children:"g++"})," compatible with\nbinaries compiled with ",(0,s.jsx)(n.code,{children:"clang"}),", ",(0,s.jsx)(n.code,{children:"clang++"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Another interesting consequence of the infrastructure work done to enable\nthis is that this enables cross compilation of C/C++ sources using ",(0,s.jsx)(n.code,{children:"gcc"}),",\n",(0,s.jsx)(n.code,{children:"g++"})," to cross-compile macOS binaries from Linux (previously only ",(0,s.jsx)(n.code,{children:"clang"}),"\nsupported this) and also cross-compile windows binaries from macOS using\nthe GCC/MinGW compilers."]}),"\n",(0,s.jsx)(n.p,{children:"To use them in conda-build recipes, you can use"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"requirements:\n  build:\n    - {{ compiler('gcc') }}   # [osx]\n    - {{ compiler('gxx') }}   # [osx]\n    - {{ stdlib('c') }}\n"})}),"\n",(0,s.jsx)(n.p,{children:"You can also do"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"c_compiler:             # [osx]\n  - gcc                 # [osx]\nc_compiler_version:     # [osx]\n  - 15                  # [osx]\ncxx_compiler:           # [osx]\n  - gxx                 # [osx]\ncxx_compiler_version:   # [osx]\n  - 15                  # [osx]\n"})}),"\n",(0,s.jsxs)(n.p,{children:["in ",(0,s.jsx)(n.code,{children:"conda_build_config.yaml"})," and continue to use the well-established\n",(0,s.jsx)(n.code,{children:'{{ compiler("c") }}'})," and ",(0,s.jsx)(n.code,{children:'{{ compiler("cxx") }}'})," macros in the recipe;\nbe aware that you're then responsible for updating the version roughly once\nper year (to keep pace with the rest of conda-forge)."]}),"\n",(0,s.jsxs)(n.p,{children:["When you are using ",(0,s.jsx)(n.code,{children:"gcc"})," locally, similar to ",(0,s.jsx)(n.code,{children:"clang"}),", we make some guesses\nabout where the macOS SDK is located. This might fail sometimes and setting\nthe environment variable ",(0,s.jsx)(n.code,{children:"SDKROOT"})," to the root of the macOS SDK should make\n",(0,s.jsx)(n.code,{children:"gcc"})," look in that folder."]}),"\n",(0,s.jsxs)(n.p,{children:["We also add by default ",(0,s.jsx)(n.code,{children:"-L $CONDA_PREFIX/lib -Wl,-rpath,$CONDA_PREFIX/lib"}),"\nwhen linkingfor local builds with the ",(0,s.jsx)(n.code,{children:"conda-gcc-specs"})," package that is\ninstalled by deault with ",(0,s.jsx)(n.code,{children:"gcc"})," package. If you want to avoid that you can\ninstall the ",(0,s.jsx)(n.code,{children:"gcc-no-conda-specs"})," package alongside ",(0,s.jsx)(n.code,{children:"gcc"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453(e,n,c){c.d(n,{R:()=>r,x:()=>a});var o=c(96540);const s={},i=o.createContext(s);function r(e){const n=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),o.createElement(i.Provider,{value:n},e.children)}},2958(e){e.exports=JSON.parse('{"permalink":"/blog/2025/11/21/gcc-macos","editUrl":"https://github.com/conda-forge/conda-forge.github.io/tree/refs/heads/main/blog/2025-11-21-gcc-macos.md","source":"@site/blog/2025-11-21-gcc-macos.md","title":"gcc, g++ builds on macos","description":"On macOS, conda-forge has provided clang, clangxx as the sole compiler","date":"2025-11-21T00:00:00.000Z","tags":[{"inline":true,"label":"infrastructure","permalink":"/blog/tags/infrastructure"}],"readingTime":2.05,"hasTruncateMarker":true,"authors":[{"name":"Isuru Fernando","title":"Member of conda-forge/core","url":"https://github.com/isuruf","imageURL":"https://github.com/isuruf.png","key":"isuruf","page":null}],"frontMatter":{"authors":["isuruf"],"tags":["infrastructure"]},"unlisted":false,"prevItem":{"title":"R support in conda-forge","permalink":"/blog/2025/11/22/r-support"},"nextItem":{"title":"Python 3.14 is already usable on conda-forge (not just available)","permalink":"/blog/2025/10/09/python-314"}}')}}]);