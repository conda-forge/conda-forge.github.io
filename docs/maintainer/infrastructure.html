

<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Infrastructure &#8212; conda-forge 2023.06.22 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/cloud.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>

    
    
     
        <script src="../_static/jquery.cookie.js"></script>
    

    
     
        <script src="../_static/cloud.base.js"></script>
    

    
     
        <script src="../_static/cloud.js"></script>
    

    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Contributing packages" href="adding_pkgs.html" />
    <link rel="prev" title="Maintainer Documentation" href="00_intro.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="adding_pkgs.html" title="Contributing packages"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="00_intro.html" title="Maintainer Documentation"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">conda-forge 2023.06.22 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="00_intro.html" accesskey="U">Maintainer Documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Infrastructure</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="infrastructure">
<span id="id1"></span><h1>Infrastructure<a class="headerlink" href="#infrastructure" title="Permalink to this heading">¶</a></h1>
<section id="repositories">
<h2>Repositories<a class="headerlink" href="#repositories" title="Permalink to this heading">¶</a></h2>
<section id="staging-area-for-recipes">
<h3>Staging area for recipes<a class="headerlink" href="#staging-area-for-recipes" title="Permalink to this heading">¶</a></h3>
<p><a class="reference external" href="https://github.com/conda-forge/staged-recipes">conda-forge/staged-recipes</a> is the entry point for new packages to join the conda-forge package collection.
You can find the detailed guide for submitting new package recipes in <a class="reference internal" href="adding_pkgs.html#creating-recipes"><span class="std std-ref">The staging process</span></a>.</p>
</section>
<section id="smithy">
<h3>Smithy<a class="headerlink" href="#smithy" title="Permalink to this heading">¶</a></h3>
<p>Smithy contains maintenance code for conda-forge, which is used by the <code class="docutils literal notranslate"><span class="pre">conda-smithy</span></code> command line tool and the <a class="reference internal" href="#dev-admservice"><span class="std std-ref">Admin web services</span></a>. Smithy lives in the repository <a class="reference external" href="https://github.com/conda-forge/conda-smithy">conda-forge/conda-smithy</a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">conda-forge/conda-smithy</span></code> is the right repository to report bugs for</p>
<blockquote>
<div><ul class="simple">
<li><p>The rerendering process</p></li>
<li><p>The recipe linter</p></li>
<li><p><a class="reference internal" href="../misc/00_intro.html#term-CI"><span class="xref std std-term">CI</span></a> support utils</p></li>
</ul>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">conda-smithy</span></code> also contains the command line tool that you should use if you rerender manually from the command line (see <a class="reference internal" href="updating_pkgs.html#dev-update-rerender"><span class="std std-ref">Rerendering feedstocks</span></a>).</p>
<p>Smithy can be used beyond Conda-Forge’s purposes. For example, it can be used to <cite>set up self-hosted Azure agents &lt;azure-config&gt;</cite> for non-Conda-Forge infrastructures.
(You could also consider using <a class="reference external" href="https://docs.microsoft.com/en-us/azure/devops/pipelines/agents/scale-set-agents?view=azure-devops">Azure virtual machine scale set agents</a>,
which could be less expensive to run than permanently active agents.)</p>
</section>
<section id="web-services">
<h3>Web services<a class="headerlink" href="#web-services" title="Permalink to this heading">¶</a></h3>
<p>The Heroku app providing the conda-forge web services lives in <a class="reference external" href="https://github.com/conda-forge/conda-forge-webservices">conda-forge/conda-forge-webservices</a>.
Please note that the code logic provided by the app is in the <code class="docutils literal notranslate"><span class="pre">Smithy</span></code> repository.</p>
<p>Bugs or suggestions regarding the service functionality should therefore be opened in <code class="docutils literal notranslate"><span class="pre">conda-forge/conda-smithy</span></code>’s <a class="reference external" href="https://github.com/conda-forge/conda-smithy/issues">bug tracker</a>.</p>
</section>
<section id="conda-forge-pinning">
<h3>conda-forge pinning<a class="headerlink" href="#conda-forge-pinning" title="Permalink to this heading">¶</a></h3>
<p>Package-wide dependency pins are defined in <a class="reference external" href="https://github.com/conda-forge/conda-forge-pinning-feedstock/blob/master/recipe/conda_build_config.yaml">conda_build_config.yaml</a> in the <a class="reference external" href="https://github.com/conda-forge/conda-forge-pinning-feedstock">conda-forge/conda-forge-pinning-feedstock</a>.</p>
<p>For more information on conda-forge wide package pins, please refer to <a class="reference internal" href="pinning_deps.html#globally-pinned-packages"><span class="std std-ref">Globally pinned packages</span></a>.</p>
<p>Please open a <a class="reference internal" href="../misc/00_intro.html#term-PR"><span class="xref std std-term">PR</span></a> and/or an issue there, if you think a pin needs to be advanced. For more information on updating globally pinned packages, please refer to <a class="reference internal" href="pinning_deps.html#update-pins"><span class="std std-ref">Updating package pins</span></a>.</p>
</section>
<section id="documentation">
<h3>Documentation<a class="headerlink" href="#documentation" title="Permalink to this heading">¶</a></h3>
<p>The documentation lives in <a class="reference external" href="https://github.com/conda-forge/conda-forge.github.io/">conda-forge/conda-forge.github.io</a>, and is automatically deployed to our <a class="reference external" href="https://conda-forge.org/docs/">online version</a>.</p>
<p>The documentation is built with <code class="docutils literal notranslate"><span class="pre">Sphinx</span></code> and the sources files are located in the <a class="reference external" href="https://github.com/conda-forge/conda-forge.github.io/tree/main/src">src</a> directory of the repository.</p>
<p>If you found any typo error, unclear explanations or new topics that can be covered, you can suggest changes to the documentation. For more details, please refer to <a class="reference internal" href="../user/contributing.html#improve-docs"><span class="std std-ref">Improve the documentation</span></a>.</p>
</section>
</section>
<section id="admin-web-services">
<span id="dev-admservice"></span><h2>Admin web services<a class="headerlink" href="#admin-web-services" title="Permalink to this heading">¶</a></h2>
<p>Conda-forge is running a webservice on Heroku called <a class="reference external" href="https://github.com/conda-forge/conda-forge-webservices">conda-forge-webservices</a>.</p>
<p>The following services are run by default on a feedstock:</p>
<ul class="simple">
<li><p>It will lint the recipes in the PRs and report back whether the recipe is in excellent condition or not.</p></li>
<li><p>When maintainers are added to a recipe, each of the maintainers will be added to the team and given push access to the feedstock.</p></li>
</ul>
<p>The webservice also listens to issues and PR comments, so that you can ask for the following services to be done:</p>
<section id="conda-forge-admin-please-rerender">
<h3>&#64;conda-forge-admin, please rerender<a class="headerlink" href="#conda-forge-admin-please-rerender" title="Permalink to this heading">¶</a></h3>
<p>Entering the above phrase in a PR of a feedstock will rerender the feedstock and push the changes to your PR.
Make sure to tick the <code class="docutils literal notranslate"><span class="pre">Allow</span> <span class="pre">edits</span> <span class="pre">from</span> <span class="pre">maintainers</span></code> button located at the bottom of the right side bar of
the PR. If you enter this phrase in the comment for an issue, the bot will create a new pull request, with the requested
re-rendering being completed.</p>
</section>
<section id="conda-forge-admin-please-add-noarch-python">
<h3>&#64;conda-forge-admin, please add noarch: python<a class="headerlink" href="#conda-forge-admin-please-add-noarch-python" title="Permalink to this heading">¶</a></h3>
<p>Entering the above phrase in a PR or an issue of a feedstock will add <code class="docutils literal notranslate"><span class="pre">noarch:</span> <span class="pre">python</span></code> to the build and rerender the feedstock
for you.</p>
</section>
<section id="conda-forge-admin-please-update-for-conda-build-3">
<h3>&#64;conda-forge-admin, please update for conda-build 3<a class="headerlink" href="#conda-forge-admin-please-update-for-conda-build-3" title="Permalink to this heading">¶</a></h3>
<p>This command will attempt to update a recipe to the new <code class="docutils literal notranslate"><span class="pre">conda-build</span> <span class="pre">3</span></code> format. It can be sent either in an issue or a PR.</p>
<p>Note that this update command is kind of a hack, and things might go wrong. Make sure to look over the changes, and ask for help if you’re not sure about something.</p>
</section>
<section id="conda-forge-admin-please-lint">
<h3>&#64;conda-forge-admin, please lint<a class="headerlink" href="#conda-forge-admin-please-lint" title="Permalink to this heading">¶</a></h3>
<p>Entering the above phrase in a PR of a feedstock will lint the PR again.</p>
</section>
<section id="conda-forge-admin-please-update-team">
<h3>&#64;conda-forge-admin, please update team<a class="headerlink" href="#conda-forge-admin-please-update-team" title="Permalink to this heading">¶</a></h3>
<p>Entering the above phrase in an issue will update the team for the feedstock. This is usually done automatically.</p>
</section>
<section id="conda-forge-admin-please-restart-ci">
<h3>&#64;conda-forge-admin, please restart ci<a class="headerlink" href="#conda-forge-admin-please-restart-ci" title="Permalink to this heading">¶</a></h3>
<p>Entering this command in the PR of a feedstock or staged-recipes will close and then open the PR, causing
all of the CI builds to restart.</p>
</section>
<section id="conda-forge-admin-please-ping-team">
<h3>&#64;conda-forge-admin, please ping team<a class="headerlink" href="#conda-forge-admin-please-ping-team" title="Permalink to this heading">¶</a></h3>
<p>Entering this command in the PR of a feedstock or staged-recipes will have the admin bot &#64;-mention the team
associated with the repo. This command can be useful for people who are not yet members of conda-forge and
so cannot &#64;-mention the <code class="docutils literal notranslate"><span class="pre">staged-recipes</span></code> team for PR reviews.</p>
</section>
<section id="conda-forge-admin-please-ping-conda-forge-team">
<h3>&#64;conda-forge-admin, please ping conda-forge/&lt;team&gt;<a class="headerlink" href="#conda-forge-admin-please-ping-conda-forge-team" title="Permalink to this heading">¶</a></h3>
<p>Entering this command in the PR of a feedstock or staged-recipes will have the admin bot &#64;-mention the respective team.
This command can be useful for people who are not yet members of conda-forge and
so cannot &#64;-mention someone due to the general GitHub limitations.</p>
</section>
<section id="conda-forge-admin-please-rerun-bot">
<h3>&#64;conda-forge-admin, please rerun bot<a class="headerlink" href="#conda-forge-admin-please-rerun-bot" title="Permalink to this heading">¶</a></h3>
<p>Entering this command in a PR comment will add the <code class="docutils literal notranslate"><span class="pre">bot-rerun</span></code> label to that PR. This label will cause
the <code class="docutils literal notranslate"><span class="pre">auto-tick</span></code> bot that issues migration and version updates to close the current PR and reissue it.
Adding this label to non-bot issued PRs will have no effect.</p>
</section>
<section id="conda-forge-admin-please-add-bot-automerge">
<h3>&#64;conda-forge-admin, please add bot automerge<a class="headerlink" href="#conda-forge-admin-please-add-bot-automerge" title="Permalink to this heading">¶</a></h3>
<p>Entering this command in the title or comment of an issue will instruct the admin bot to
open a PR enabling the automatic merging of passing PRs from the <code class="docutils literal notranslate"><span class="pre">auto-tick</span></code>
bot. This functionality is currently experimental. You can find more details
<a class="reference internal" href="#automerge"><span class="std std-ref">here</span></a>.
Please open issue on <code class="docutils literal notranslate"><span class="pre">regro/cf-scripts</span></code> for any feedback, bugs, and/or questions!</p>
</section>
<section id="conda-forge-admin-please-remove-bot-automerge">
<h3>&#64;conda-forge-admin, please remove bot automerge<a class="headerlink" href="#conda-forge-admin-please-remove-bot-automerge" title="Permalink to this heading">¶</a></h3>
<p>Entering this command in the title or comment of an issue will instruct the admin bot to
open a PR to disable automerge, undoing the <code class="docutils literal notranslate"><span class="pre">please</span> <span class="pre">add</span> <span class="pre">bot</span> <span class="pre">automerge</span></code> command.</p>
</section>
<section id="conda-forge-admin-please-add-user-username">
<h3>&#64;conda-forge-admin, please add user &#64;username<a class="headerlink" href="#conda-forge-admin-please-add-user-username" title="Permalink to this heading">¶</a></h3>
<p>Entering the above phrase in the title of an issue on a feedstock will make a PR
that adds the given user to the feedstock. A maintainer or member of <code class="docutils literal notranslate"><span class="pre">core</span></code> can then merge
this PR to add the user. Please do not modify this PR or adjust the commit message. This
PR is designed to skip building the package.</p>
</section>
<section id="conda-forge-admin-update-version">
<h3>&#64;conda-forge-admin, update version<a class="headerlink" href="#conda-forge-admin-update-version" title="Permalink to this heading">¶</a></h3>
<p>Entering the above phrase in the title of an issue on a feedstock will request the bot
to check if there are any new versions available. If there are, it will open a PR with
with the needed changes. Note that the bot might start by opening a PR with only partial
changes. The rest of the contents will be added in a subsequent commit after a few minutes.</p>
</section>
</section>
<section id="ci-build-services">
<h2>CI build services<a class="headerlink" href="#ci-build-services" title="Permalink to this heading">¶</a></h2>
<p>Here we describe common issues with the CI Services that conda-forge builds.</p>
<section id="azure-pipelines">
<h3>Azure Pipelines<a class="headerlink" href="#azure-pipelines" title="Permalink to this heading">¶</a></h3>
<p>Azure is used to build packages for OSX, Linux (x86_64, native), Linux (ARMv8, emulated) and Linux (IBM Power8+, emulated).
The build queue on Azure is substantially larger than on all the other providers.
Azure builds have a maximum duration of 6 hours.</p>
<p>To see all builds on Azure, visit <a class="reference external" href="https://dev.azure.com/conda-forge/feedstock-builds/_build">https://dev.azure.com/conda-forge/feedstock-builds/_build</a>.</p>
<section id="restarting-builds">
<h4>Restarting builds<a class="headerlink" href="#restarting-builds" title="Permalink to this heading">¶</a></h4>
<p>Presently Azure does not sync GitHub users. In order to restart a build you can restart it from the GitHub checks interface.
If that doesn’t work, a close/open will kick off a new build. You can also use the web services command <code class="docutils literal notranslate"><span class="pre">&#64;conda-forge-admin,</span> <span class="pre">please</span> <span class="pre">restart</span> <span class="pre">ci</span></code>.</p>
</section>
<section id="using-azure-for-everything">
<h4>Using Azure for <em>everything</em><a class="headerlink" href="#using-azure-for-everything" title="Permalink to this heading">¶</a></h4>
<p>Azure is the default provider for Linux and OSX.  To use Azure for everything, add the following to <code class="docutils literal notranslate"><span class="pre">conda-forge.yml</span></code> in the root
of the feedstock.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">provider</span><span class="p">:</span>
<span class="w">  </span><span class="nt">win</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Presently Azure has some issues building libraries using cmake on Windows. Azure does not have a VS2008 installation, so building
certain very old packages that require VC9 will fail.</p>
</div>
</section>
</section>
<section id="travisci-ibm-power-8-arm">
<h3>TravisCI (IBM Power 8+, ARM)<a class="headerlink" href="#travisci-ibm-power-8-arm" title="Permalink to this heading">¶</a></h3>
<p>TravisCI is used to build packages for IBM Power 8+ and ARM. After merging a staged-recipes pull request, it might be necessary to
force sync your repositories in TravisCI to see the reload and cancel buttons. To do this please visit <a class="reference external" href="https://app.travis-ci.com/account/repositories">https://app.travis-ci.com/account/repositories</a>
and click the “Sync accounts” button.</p>
<section id="enabling-travis">
<h4>Enabling Travis<a class="headerlink" href="#enabling-travis" title="Permalink to this heading">¶</a></h4>
<p>TravisCI should only be needed to build recipes on OSX, if there is a strange failure on Azure.</p>
<p>Enable a build by adding the following to <code class="docutils literal notranslate"><span class="pre">conda-forge.yml</span></code> in the root of the feedstock.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">provider</span><span class="p">:</span>
<span class="w">  </span><span class="nt">osx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">travis</span>
</pre></div>
</div>
<p>For IBM Power 8+ and/or ARM builds, add the name of your feedstock to the list <a class="reference external" href="https://github.com/conda-forge/conda-forge-pinning-feedstock/blob/master/recipe/migrations/arch_rebuild.txt">here</a>
via a pull request.</p>
</section>
</section>
<section id="github-actions">
<h3>GitHub Actions<a class="headerlink" href="#github-actions" title="Permalink to this heading">¶</a></h3>
<p>We use GitHub actions to rerender feedstocks and also run our pull request automerge service. We do not currently support builds on
GitHub Actions.</p>
<section id="automerge">
<span id="id2"></span><h4>Automerge<a class="headerlink" href="#automerge" title="Permalink to this heading">¶</a></h4>
<p>The automerge service uses the GitHub action in this <a class="reference external" href="https://github.com/conda-forge/automerge-action">repo</a>. This action runs out of a
Docker <a class="reference external" href="https://hub.docker.com/repository/docker/condaforge/automerge-action">container</a> on the <code class="docutils literal notranslate"><span class="pre">prod</span></code> tag. See the
repo <a class="reference external" href="https://github.com/conda-forge/automerge-action#readme">README.md</a> for more details. PRs are automatically merged if they satisfy either
of the two following sets of conditions:</p>
<ol class="arabic simple">
<li><p>are from the <code class="docutils literal notranslate"><span class="pre">regro-cf-autotick-bot</span></code>, have <code class="docutils literal notranslate"><span class="pre">[bot-automerge]</span></code> in the title, all statuses are passing, and the feedstock allows automerge</p></li>
<li><p>have the <code class="docutils literal notranslate"><span class="pre">automerge</span></code> label and all statuses are passing.</p></li>
</ol>
<p>For PRs from the <code class="docutils literal notranslate"><span class="pre">regro-cf-autotick-bot</span></code>, it can be useful to remove the <code class="docutils literal notranslate"><span class="pre">[bot-automerge]</span></code> slug from the PR title if you are making
edits to the PR.</p>
</section>
<section id="rerendering">
<h4>Rerendering<a class="headerlink" href="#rerendering" title="Permalink to this heading">¶</a></h4>
<p>The rerendering service is triggered by the Heroku app. It uses the GitHub action in this <a class="reference external" href="https://github.com/conda-forge/webservices-dispatch-action">repo</a>.
This action runs out of a Docker <a class="reference external" href="https://hub.docker.com/repository/docker/condaforge/webservices-dispatch-action">container</a> on the <code class="docutils literal notranslate"><span class="pre">prod</span></code> tag. See the
repo <a class="reference external" href="https://github.com/conda-forge/webservices-dispatch-action#readme">README.md</a> for more details.</p>
</section>
</section>
<section id="skipping-ci-builds">
<h3>Skipping CI builds<a class="headerlink" href="#skipping-ci-builds" title="Permalink to this heading">¶</a></h3>
<p>To skip a CI build for a given commit, put <code class="docutils literal notranslate"><span class="pre">[ci</span> <span class="pre">skip]</span> <span class="pre">***NO_CI***</span></code> in the commit message.</p>
<div class="admonition-related-links admonition">
<p class="admonition-title">Related links</p>
<ul class="simple">
<li><p><strong>Abort builds with [skip ci]/etc</strong> <a class="reference external" href="https://github.com/conda-forge/conda-forge.github.io/issues/629">(conda-forge.github.io/#629)</a></p></li>
<li><p><strong>Skip CI requests</strong> <a class="reference external" href="https://github.com/conda-forge/staged-recipes/issues/1148">(staged-recipes/#1148)</a></p></li>
</ul>
</div>
</section>
<section id="third-party-use-of-our-ci-services">
<h3>Third-party Use of Our CI Services<a class="headerlink" href="#third-party-use-of-our-ci-services" title="Permalink to this heading">¶</a></h3>
<p>Due to its stature in the open-source community, conda-forge has enhanced access to certain CI services. This access is a community
resource entrusted to conda-forge for use in building packages. We thus cannot support third-party or “off-label” CI jobs in our
feedstocks on any of our CI services. If we find such use, we will politely ask the maintainers to rectify the situation. We may
take more serious actions, including archiving feedstocks or removing maintainers from the organization, if the situation cannot be rectified.</p>
</section>
</section>
<section id="compilers-and-runtimes">
<h2>Compilers and Runtimes<a class="headerlink" href="#compilers-and-runtimes" title="Permalink to this heading">¶</a></h2>
<p>Conda-forge builds and maintains its own set of compilers for various languages
and/or systems (e.g., <code class="docutils literal notranslate"><span class="pre">C</span></code>, <code class="docutils literal notranslate"><span class="pre">FORTRAN</span></code>, <code class="docutils literal notranslate"><span class="pre">C++</span></code>, <code class="docutils literal notranslate"><span class="pre">CUDA</span></code>, etc.). These are used
in all of our CI builds to build both core dependencies (e.g., <code class="docutils literal notranslate"><span class="pre">Python</span></code>) and maintainer-contributed
packages. While we do not have any formal policies or promises of support for these
compilers, we have historically maintained them according to the following (non-binding)
principles.</p>
<ul class="simple">
<li><p>The authoritative source of the current compilers and versions for various languages
and platforms is the <a class="reference external" href="https://github.com/conda-forge/conda-forge-pinning-feedstock/blob/master/recipe/conda_build_config.yaml">conda_build_config.yaml</a>
in the <a class="reference external" href="https://github.com/conda-forge/conda-forge-pinning-feedstock">conda-forge/conda-forge-pinning-feedstock</a>
as described in <a class="reference internal" href="pinning_deps.html#globally-pinned-packages"><span class="std std-ref">Globally pinned packages</span></a>.</p></li>
<li><p>We provide no support of any kind in terms of the long-term stability of these pinnings.</p></li>
<li><p>We upgrade them in an ad-hoc manner on a periodic basis as we have the time and energy to do so.
Note that because of the way we enforce runtime constraints, these compiler upgrades will not break
existing packages. However, if you are using the compilers outside of <code class="docutils literal notranslate"><span class="pre">conda</span></code>, then you may find issues.</p></li>
<li><p>We generally provide notice in the form of an announcement when a compiler is going to be upgraded.
Note that these changes take a bit of time to complete, so you will generally have time
to prepare should you need to.</p></li>
<li><p>Some of the criteria we think about when considering a compiler migration include
1) the degree of disruption to the ecosystem, 2) the amount of work for the <code class="docutils literal notranslate"><span class="pre">core</span></code> team,
and 3) the amount of time it will cost our (volunteer) feedstock maintainers.</p></li>
</ul>
<p>We do use some unofficial names for our compiler stack internally. Note however that
the existence of these names does not imply any level of support or stability for the compilers
that form the given stack.</p>
<ul class="simple">
<li><p>Our current compiler stack is referred to internally as <code class="docutils literal notranslate"><span class="pre">comp7</span></code>.</p></li>
<li><p>The previous compiler stack based in part on the various <code class="docutils literal notranslate"><span class="pre">toolchain_*</span></code> packages
was sometimes referred to as <code class="docutils literal notranslate"><span class="pre">comp4</span></code>. On linux the <code class="docutils literal notranslate"><span class="pre">toolchain_*</span></code> compilers were
GCC 4.8.2 as packaged in the devtoolset-2 software collection. On osx, we use clang from
Apple’s Xcode in the <code class="docutils literal notranslate"><span class="pre">toolchain_*</span></code> packages.</p></li>
</ul>
<section id="centos-sysroot-for-linux-platforms">
<h3>CentOS <code class="docutils literal notranslate"><span class="pre">sysroot</span></code> for <code class="docutils literal notranslate"><span class="pre">linux-*</span></code> Platforms<a class="headerlink" href="#centos-sysroot-for-linux-platforms" title="Permalink to this heading">¶</a></h3>
<p>We currently repackage the <code class="docutils literal notranslate"><span class="pre">sysroot</span></code> from the appropriate version of CentOS for use
with our compilers. These <code class="docutils literal notranslate"><span class="pre">sysroot</span></code> files are available in the <code class="docutils literal notranslate"><span class="pre">sysroot_linux-*</span></code> packages.
These packages have version numbers that match the version of <code class="docutils literal notranslate"><span class="pre">glibc</span></code> they package. These
versions are <code class="docutils literal notranslate"><span class="pre">2.12</span></code> for CentOS 6 and <code class="docutils literal notranslate"><span class="pre">2.17</span></code> for CentOS 7.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">gcc</span></code>/<code class="docutils literal notranslate"><span class="pre">gxx</span></code>/<code class="docutils literal notranslate"><span class="pre">gfortran</span></code> versions prior to <code class="docutils literal notranslate"><span class="pre">8.4.0</span></code> on <code class="docutils literal notranslate"><span class="pre">ppc64le</span></code> and <code class="docutils literal notranslate"><span class="pre">7.5.0</span></code>
on <code class="docutils literal notranslate"><span class="pre">aarch64</span></code>/<code class="docutils literal notranslate"><span class="pre">x86_64</span></code>, we had been building our own versions of <code class="docutils literal notranslate"><span class="pre">glibc</span></code>. This practice
is now deprecated in favor of the CentOS-based <code class="docutils literal notranslate"><span class="pre">sysroots</span></code>. Additionally, as of the same
compiler versions above, we have removed the <code class="docutils literal notranslate"><span class="pre">cos*</span></code> part of the <code class="docutils literal notranslate"><span class="pre">sysroot</span></code> path. The new
<code class="docutils literal notranslate"><span class="pre">sysroot</span></code> path has in it simply <code class="docutils literal notranslate"><span class="pre">conda</span></code> as opposed to <code class="docutils literal notranslate"><span class="pre">conda_cos6</span></code> or <code class="docutils literal notranslate"><span class="pre">conda_cos7</span></code>.</p>
</section>
</section>
<section id="output-validation-and-feedstock-tokens">
<span id="output-validation"></span><h2>Output Validation and Feedstock Tokens<a class="headerlink" href="#output-validation-and-feedstock-tokens" title="Permalink to this heading">¶</a></h2>
<p>As of writing, <code class="docutils literal notranslate"><span class="pre">anaconda.org</span></code> does not support generating API tokens that are scoped
to allow uploads for some packages but not others. In order to secure feedstock uploads,
so that, e.g., the maintainers of the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> feedstock cannot push a <code class="docutils literal notranslate"><span class="pre">python</span></code> package,
we use a package staging process and issue secret tokens, unique to each feedback. This process
works as follows.</p>
<ol class="arabic simple">
<li><p>When a CI job on a feedstock is building packages to be uploaded to <code class="docutils literal notranslate"><span class="pre">anaconda.org</span></code>, it
first uploads them to a staging channel, <code class="docutils literal notranslate"><span class="pre">cf-staging</span></code>.</p></li>
<li><p>Then the feedback CI job makes an API call to our admin webservices server with its secret token
and some information about the package it is trying to upload.</p></li>
<li><p>The webservices server validates the secret token, the integrity of the package, and
that the package is allowed for the given feedstock.</p></li>
<li><p>If all of the validation passes, the package is then copied to the <code class="docutils literal notranslate"><span class="pre">conda-forge</span></code>
channel.</p></li>
</ol>
<p>We attempt to report errors in this process to users via comments on commits/issues in the feedstocks.
Note however that sometimes these fail. If you think you are having trouble with uploads, make
sure <code class="docutils literal notranslate"><span class="pre">conda_forge_output_validation:</span> <span class="pre">true</span></code> is set in your <code class="docutils literal notranslate"><span class="pre">conda-forge.yml</span></code> and rerender
your feedstock with the latest version of <code class="docutils literal notranslate"><span class="pre">conda-smithy</span></code>. Finally, new packages that are added to
feedstocks are registered automatically and once uploaded successfully, no other feedstock
will be able to upload packages with the same name.</p>
<p>Sometimes, however, it might make better sense to generate a package from a different
feedstock, say, due to package renaming or re-structuring. In this case, you may need
to add the new feedstock to the <a class="reference external" href="https://github.com/conda-forge/feedstock-outputs">feedstock-outputs</a> map.
If this is not done, then the output validation process will block the package from being
uploaded from the new feedstock, by design.
Once this is done correctly and the package is uploaded,
you can then request the conda-forge core devs to archive the old feedstock.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="../index.html">Overview</a></h3>
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user/00_intro.html">User Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="00_intro.html">Maintainer Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Infrastructure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#repositories">Repositories</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#staging-area-for-recipes">Staging area for recipes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#smithy">Smithy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#web-services">Web services</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conda-forge-pinning">conda-forge pinning</a></li>
<li class="toctree-l4"><a class="reference internal" href="#documentation">Documentation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#admin-web-services">Admin web services</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#conda-forge-admin-please-rerender">&#64;conda-forge-admin, please rerender</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conda-forge-admin-please-add-noarch-python">&#64;conda-forge-admin, please add noarch: python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conda-forge-admin-please-update-for-conda-build-3">&#64;conda-forge-admin, please update for conda-build 3</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conda-forge-admin-please-lint">&#64;conda-forge-admin, please lint</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conda-forge-admin-please-update-team">&#64;conda-forge-admin, please update team</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conda-forge-admin-please-restart-ci">&#64;conda-forge-admin, please restart ci</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conda-forge-admin-please-ping-team">&#64;conda-forge-admin, please ping team</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conda-forge-admin-please-ping-conda-forge-team">&#64;conda-forge-admin, please ping conda-forge/&lt;team&gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conda-forge-admin-please-rerun-bot">&#64;conda-forge-admin, please rerun bot</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conda-forge-admin-please-add-bot-automerge">&#64;conda-forge-admin, please add bot automerge</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conda-forge-admin-please-remove-bot-automerge">&#64;conda-forge-admin, please remove bot automerge</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conda-forge-admin-please-add-user-username">&#64;conda-forge-admin, please add user &#64;username</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conda-forge-admin-update-version">&#64;conda-forge-admin, update version</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ci-build-services">CI build services</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#azure-pipelines">Azure Pipelines</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#restarting-builds">Restarting builds</a></li>
<li class="toctree-l5"><a class="reference internal" href="#using-azure-for-everything">Using Azure for <em>everything</em></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#travisci-ibm-power-8-arm">TravisCI (IBM Power 8+, ARM)</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#enabling-travis">Enabling Travis</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#github-actions">GitHub Actions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#automerge">Automerge</a></li>
<li class="toctree-l5"><a class="reference internal" href="#rerendering">Rerendering</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#skipping-ci-builds">Skipping CI builds</a></li>
<li class="toctree-l4"><a class="reference internal" href="#third-party-use-of-our-ci-services">Third-party Use of Our CI Services</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#compilers-and-runtimes">Compilers and Runtimes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#centos-sysroot-for-linux-platforms">CentOS <code class="docutils literal notranslate"><span class="pre">sysroot</span></code> for <code class="docutils literal notranslate"><span class="pre">linux-*</span></code> Platforms</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#output-validation-and-feedstock-tokens">Output Validation and Feedstock Tokens</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="adding_pkgs.html">Contributing packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="updating_pkgs.html">Maintaining packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="pinning_deps.html">Pinned dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="conda_forge_yml.html">Configuring conda-forge.yml</a></li>
<li class="toctree-l2"><a class="reference internal" href="knowledge_base.html">Knowledge Base</a></li>
<li class="toctree-l2"><a class="reference internal" href="maintainer_faq.html">FAQ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../orga/00_intro.html">Organisation Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/00_intro.html">Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contracting/00_intro.html">Contracting Information</a></li>
</ul>

  </div>
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="00_intro.html"
                          title="Previous page">&larr; Maintainer Documentation</a></p>
  </div>
  <div class="sphinxnext">
    <h4>Next page</h4>
    <p class="topless"><a href="adding_pkgs.html"
                          title="Next page">&rarr; Contributing packages</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/maintainer/infrastructure.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="adding_pkgs.html" title="Contributing packages"
             >next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="00_intro.html" title="Maintainer Documentation"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">conda-forge 2023.06.22 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="00_intro.html" >Maintainer Documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Infrastructure</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2023, conda-forge.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>