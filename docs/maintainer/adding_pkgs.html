

<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Contributing packages &#8212; conda-forge 2023.06.22 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/cloud.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>

    
    
     
        <script src="../_static/jquery.cookie.js"></script>
    

    
     
        <script src="../_static/cloud.base.js"></script>
    

    
     
        <script src="../_static/cloud.js"></script>
    

    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Maintaining packages" href="updating_pkgs.html" />
    <link rel="prev" title="Infrastructure" href="infrastructure.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="updating_pkgs.html" title="Maintaining packages"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="infrastructure.html" title="Infrastructure"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">conda-forge 2023.06.22 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="00_intro.html" accesskey="U">Maintainer Documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Contributing packages</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="contributing-packages">
<span id="dev-contribute-pkgs"></span><h1>Contributing packages<a class="headerlink" href="#contributing-packages" title="Permalink to this heading">¶</a></h1>
<p>To submit a package to the <code class="docutils literal notranslate"><span class="pre">conda-forge</span></code> channel, add its <code class="docutils literal notranslate"><span class="pre">recipe</span></code> and licence to the <code class="docutils literal notranslate"><span class="pre">staged-recipes</span></code> repository and create a pull request. Once the pull request is merged, the package becomes available on the <code class="docutils literal notranslate"><span class="pre">conda-forge</span></code> channel.</p>
<p>The sections below provide detailed instructions on contributing packages to conda-forge.</p>
<section id="the-staging-process">
<span id="creating-recipes"></span><h2>The staging process<a class="headerlink" href="#the-staging-process" title="Permalink to this heading">¶</a></h2>
<p>The staging process i.e adding a package’s recipe has three steps:</p>
<ol class="arabic simple">
<li><p>Generating the recipe</p></li>
<li><p>Checklist</p></li>
<li><p>Feedback and revision</p></li>
</ol>
<section id="generating-the-recipe">
<h3>Generating the recipe<a class="headerlink" href="#generating-the-recipe" title="Permalink to this heading">¶</a></h3>
<p>There are, currently, three ways to generate a recipe:</p>
<ol class="arabic simple">
<li><p>If it is an R package from <a class="reference external" href="https://cran.r-project.org/">CRAN</a>, kindly
start by using the <a class="reference external" href="https://github.com/bgruening/conda_r_skeleton_helper">conda-forge helper script for R recipes</a> instead.
Then if necessary, you can make manual edits to the recipe.</p></li>
<li><p>If it is a python package, you can generate the recipe as a starting point with <code class="docutils literal notranslate"><span class="pre">grayskull</span></code>.</p></li>
</ol>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference external" href="https://github.com/conda-incubator/grayskull">Grayskull</a> is an automatic conda recipe generator. The goal of this project is to generate concise recipes
for conda-forge and eventually replace conda skeleton. Presently, Grayskull can generate recipes for Python packages available on PyPI and also those not published on PyPI and only available as GitHub repositories.</p>
<p>Installation and usage of <code class="docutils literal notranslate"><span class="pre">grayskull</span></code>:</p>
<ul class="simple">
<li><p>Create a new environment using : <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">create</span> <span class="pre">--name</span> <span class="pre">MY_ENV</span></code>. Replace <code class="docutils literal notranslate"><span class="pre">MY_ENV</span></code> with the environment name.</p></li>
<li><p>Activate this new environment : <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">activate</span> <span class="pre">MY_ENV</span></code>.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">-c</span> <span class="pre">conda-forge</span> <span class="pre">grayskull</span></code> to install <code class="docutils literal notranslate"><span class="pre">grayskull</span></code>.</p></li>
<li><p>Followed by <code class="docutils literal notranslate"><span class="pre">grayskull</span> <span class="pre">pypi</span> <span class="pre">--strict-conda-forge</span> <span class="pre">YOUR_PACKAGE_NAME</span></code> to generate the recipe. Replace <code class="docutils literal notranslate"><span class="pre">YOUR_PACKAGE_NAME</span></code> with the package name.</p></li>
</ul>
</div>
<p>You do <em>not</em> necessarily have to use <code class="docutils literal notranslate"><span class="pre">grayskull</span></code>, and the recipes produced by <code class="docutils literal notranslate"><span class="pre">grayskull</span></code> might need to be reviewed and edited.
Read more about <code class="docutils literal notranslate"><span class="pre">grayskull</span></code> and how to use it <a class="reference external" href="https://github.com/conda-incubator/grayskull#introduction">here</a>.</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>If it’s none of the above, generate a recipe with the help of <a class="reference external" href="https://github.com/conda-forge/staged-recipes/tree/master/recipes/example">the example recipe</a> in the <a class="reference external" href="https://github.com/conda-forge/staged-recipes">staged-recipes repository</a> and modify it as necessary.</p></li>
</ol>
<p>Your final recipe should have no comments (unless they’re actually relevant to the recipe, and not generic instruction comments), and follow the order in the example.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If there are any details you are not sure about please create a pull request anyway. The conda-forge team will review it and help you make changes to it.</p>
</div>
<p>In case you are building your first recipe using conda-forge, a step-by-step instruction and checklist that will help you with a successful build is provided below.</p>
</section>
<section id="step-by-step-instructions">
<span id="staging-steps"></span><h3>Step-by-step Instructions<a class="headerlink" href="#step-by-step-instructions" title="Permalink to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>Ensure your source code can be downloaded as a single file. Source code
should be downloadable as an archive (.tar.gz, .zip, .tar.bz2, .tar.xz)
or tagged on GitHub, to ensure that it can be verified. (For further
detail, see <a class="reference internal" href="#tarballs-no-repos"><span class="std std-ref">Build from tarballs, not repos</span></a>).</p></li>
<li><p>Fork and clone the <a class="reference external" href="https://github.com/conda-forge/staged-recipes">staged-recipes</a>
repository from GitHub.</p></li>
<li><p>Checkout a new branch from the staged-recipes <code class="docutils literal notranslate"><span class="pre">main</span></code> branch.</p></li>
<li><p>Through CLI, cd inside the ‘staged-recipes/recipes’ directory.</p></li>
<li><p>Within your forked copy, create a new folder in the recipes folder for your package (i.e, <code class="docutils literal notranslate"><span class="pre">...staged-recipes/recipes/&lt;name-of-package&gt;</span></code>)</p></li>
<li><p>Copy <a class="reference external" href="https://github.com/conda-forge/staged-recipes/blob/master/recipes/example/meta.yaml">meta.yaml</a> from the example directory.
All the changes in the following steps will happen in the COPIED meta.yaml (i.e., <code class="docutils literal notranslate"><span class="pre">...staged-recipes/recipes/&lt;name-of-package&gt;/meta.yaml</span></code>).
Please leave the example directory unchanged!</p></li>
<li><p>Modify the copied recipe (meta.yml) as needed. To see how to modify meta.yaml, take a look at
<a class="reference internal" href="#id2"><span class="std std-ref">The recipe meta.yaml</span></a>.</p></li>
<li><p>Generate the SHA256 key for your source code archive, as described in the
example recipe using the <code class="docutils literal notranslate"><span class="pre">openssl</span></code> tool. As an alternative, you can also
go to the package description on <a class="reference external" href="https://pypi.org">PyPi</a> from which you
can directly copy the SHA256.</p></li>
<li><p>Be sure to fill in the <code class="docutils literal notranslate"><span class="pre">test</span></code> section. The simplest test will simply
test that the module can be imported, as described in the example.</p></li>
<li><p>Remove all irrelevant comments in the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code>  file.</p></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Be sure not to checksum the redirection page. Therefore use, for example,:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">sL</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">username</span><span class="o">/</span><span class="n">reponame</span><span class="o">/</span><span class="n">archive</span><span class="o">/</span><span class="n">vX</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span> <span class="o">|</span> <span class="n">openssl</span> <span class="n">sha256</span>
</pre></div>
</div>
</div>
<section id="checklist">
<h4>Checklist<a class="headerlink" href="#checklist" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Ensure that the license and license family descriptors (optional) have the right case and that the license is correct. Note that case sensitive inputs are required (e.g. Apache-2.0 rather than APACHE 2.0). Using SPDX identifiers for license field is recommended. (see <a class="reference internal" href="#spdx"><span class="std std-ref">SPDX Identifiers and Expressions</span></a>)</p></li>
<li><p>Ensure that you have included a license file if your license requires one – most do. (see <a class="reference external" href="https://github.com/conda-forge/staged-recipes/blob/a504af81c05491bf7b0b018b2fa1efe64767985c/recipes/example/meta.yaml#L52-L55">here</a>)</p></li>
<li><p>In case your project has tests included, you need to decide if these tests should be executed while building the conda-forge feedstock.</p></li>
<li><p>Make sure that all tests pass successfully at least on your development machine.</p></li>
<li><p>Recommended: run the test locally on your source code to ensure the recipe works locally (see  <a class="reference internal" href="#staging-test-locally"><span class="std std-ref">Running tests locally for staged recipes</span></a>).</p></li>
<li><p>Make sure that your changes do not interfere with other recipes that are in the <code class="docutils literal notranslate"><span class="pre">recipes</span></code> folder (e.g. the <code class="docutils literal notranslate"><span class="pre">example</span></code> recipe).</p></li>
</ul>
</section>
</section>
<section id="feedback-and-revision">
<h3>Feedback and revision<a class="headerlink" href="#feedback-and-revision" title="Permalink to this heading">¶</a></h3>
<p>Once you finished your PR, all you have to do is wait for feedback from our review team.</p>
<p>The review team will assist you by pointing out improvements and answering questions. Once the package is ready, the reviewers will approve and merge your pull request.</p>
<p>After merging the <a class="reference internal" href="../misc/00_intro.html#term-PR"><span class="xref std std-term">PR</span></a>, our <a class="reference internal" href="../misc/00_intro.html#term-CI"><span class="xref std std-term">CI</span></a> infrastructure will build the package and make it available in the conda-channel.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have questions or have not heard back for a while, you can notify us by including <code class="docutils literal notranslate"><span class="pre">&#64;conda-forge/staged-recipes</span></code> in your GitHub message.</p>
</div>
</section>
<section id="post-staging-process">
<h3>Post staging process<a class="headerlink" href="#post-staging-process" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>After the PR is merged, our <a class="reference internal" href="../misc/00_intro.html#term-CI"><span class="xref std std-term">CI</span></a> services will create a new git repo automatically. For example, the recipe for a package named <code class="docutils literal notranslate"><span class="pre">pydstool</span></code> will be moved to a new repository <a class="reference external" href="https://github.com/conda-forge/pydstool-feedstock">https://github.com/conda-forge/pydstool-feedstock</a>. This process is automated through a CI job on the <code class="docutils literal notranslate"><span class="pre">conda-forge/staged-recipes</span></code> repo. It sometimes fails due to API rate limits and will automatically retry itself. If your feedstock has not been created after a day or so, please get in touch with the <code class="docutils literal notranslate"><span class="pre">conda-forge/core</span></code> team for help.</p></li>
<li><p>CI services will be enabled automatically and a build will be triggered automatically which will build the conda package and upload to <a class="reference external" href="https://anaconda.org/conda-forge">https://anaconda.org/conda-forge</a></p></li>
<li><p>If this is your first contribution, you will be added to the conda-forge <a class="reference external" href="https://github.com/orgs/conda-forge/people">team</a> and given access to the CI services so that you can stop and restart builds. You will also be given commit rights to the new git repository.</p></li>
<li><p>If you want to make a change to the recipe, send a <a class="reference internal" href="../misc/00_intro.html#term-PR"><span class="xref std std-term">PR</span></a> to the git repository from a fork. Branches of the main repository are used for maintaining different versions only.</p></li>
</ul>
</section>
<section id="feedstock-repository-structure">
<span id="id1"></span><h3>Feedstock repository structure<a class="headerlink" href="#feedstock-repository-structure" title="Permalink to this heading">¶</a></h3>
<p>Once the PR containing the recipe for a package is merged in the <code class="docutils literal notranslate"><span class="pre">staged-recipes</span></code> repository, a new repository is created automatically called <code class="docutils literal notranslate"><span class="pre">&lt;package-name&gt;-feedstock</span></code>.
A feedstock is made up of a conda recipe (the instructions on what and how to build the package) and the necessary configuration files for automatic builds using freely available continuous integration (CI) services.</p>
<p>Each feedstock contains various files that are generated automatically using our automated provisioning tool <a class="reference external" href="https://github.com/conda-forge/conda-smithy/">conda-smithy</a>. Broadly every feedstock has the following files:</p>
<section id="recipe">
<h4>recipe<a class="headerlink" href="#recipe" title="Permalink to this heading">¶</a></h4>
<p>This folder contains the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file and any other files/scripts needed to build the package.</p>
</section>
<section id="license-txt">
<h4>LICENSE.txt<a class="headerlink" href="#license-txt" title="Permalink to this heading">¶</a></h4>
<p>This file is the license for the recipe itself. This license is different from the package license, which you define while submitting the package recipe using <code class="docutils literal notranslate"><span class="pre">license_file</span></code> in the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file.</p>
</section>
<section id="ci-files">
<h4>CI-files<a class="headerlink" href="#ci-files" title="Permalink to this heading">¶</a></h4>
<p>These are the CI configuration files for service providers like Azure and TravisCI.</p>
</section>
<section id="conda-forge-yml">
<h4>conda-forge.yml<a class="headerlink" href="#conda-forge-yml" title="Permalink to this heading">¶</a></h4>
<p>This file is used to configure how the feedstock is set up and built. Making any changes in this file usually requires <a class="reference external" href="https://conda-forge.org/docs/maintainer/updating_pkgs.html#dev-update-rerender">rerendering the feedstock</a>.</p>
</section>
</section>
<section id="maintainer-role">
<h3>Maintainer role<a class="headerlink" href="#maintainer-role" title="Permalink to this heading">¶</a></h3>
<p>The maintainer’s job is to:</p>
<ul class="simple">
<li><p>Keep the feedstock updated by merging eventual maintenance <a class="reference internal" href="../misc/00_intro.html#term-PR"><span class="xref std std-term">PR</span></a>s from conda-forge’s bots.</p></li>
<li><p>Keep the feedstock on par with new releases of the source package by:</p>
<ul>
<li><p>Bumping the version number and checksum.</p></li>
<li><p>Making sure that the feedstock’s requirements stay accurate.</p></li>
<li><p>Make sure the test requirements match those of the updated package.</p></li>
</ul>
</li>
<li><p>Answer eventual questions about the package on the feedstock issue tracker.</p></li>
</ul>
</section>
<section id="adding-multiple-packages-at-once">
<h3>Adding multiple packages at once<a class="headerlink" href="#adding-multiple-packages-at-once" title="Permalink to this heading">¶</a></h3>
<p>If you would like to add more than one related packages, they can be added to
staged-recipes in a single pull request (in separate directories). If the
packages are interdependent (i.e. one package being added lists one or more of
the other packages being added as a requirement), the build script will be able to
locate the dependencies that are only present within staged-recipes as long as
the builds finish in the dependencies order. Using a single pull request
allows you to quickly get packages set up without waiting for each package in a
dependency chain to be reviewed, built, and added to the conda-forge channel
before starting the process over with the next recipe in the chain.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When PRs with multiple interdependent recipes are merged,
there may be an error if a build finishes before its dependency is built. If
this occurs, you can trigger a new build by pushing an empty commit.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>git commit --amend --no-edit &amp;&amp; git push --force
</pre></div>
</div>
</div>
</section>
<section id="synchronizing-fork-for-future-use">
<h3>Synchronizing fork for future use<a class="headerlink" href="#synchronizing-fork-for-future-use" title="Permalink to this heading">¶</a></h3>
<p>If you would like to add additional packages in the future, you will need to
reset your fork of staged-recipes before creating a new branch on your fork,
adding the new package directory/recipe, and creating a pull request. This
step ensures you have the most recent version of the tools and configuration
files contained in the staged-recipes repository and makes the pull request
much easier to review. The following steps will reset your fork of
staged-recipes and should be executed from within a clone of your forked
staged-recipes directory.</p>
<ol class="arabic">
<li><p>Checkout your main branch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">checkout</span> <span class="n">main</span>
</pre></div>
</div>
</li>
<li><p>Define the conda-forge/staged-recipes repository as <code class="docutils literal notranslate"><span class="pre">upstream</span></code> (if you have not already done so).:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">remote</span> <span class="n">add</span> <span class="n">upstream</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">conda</span><span class="o">-</span><span class="n">forge</span><span class="o">/</span><span class="n">staged</span><span class="o">-</span><span class="n">recipes</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</li>
<li><p>Pull all of the upstream commits from the upstream main branch.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">pull</span> <span class="o">--</span><span class="n">rebase</span> <span class="n">upstream</span> <span class="n">main</span>
</pre></div>
</div>
</li>
<li><p>Push all of the changes to your fork on GitHub (make sure there are not any changes on GitHub that you need because they will be overwritten).:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">push</span> <span class="n">origin</span> <span class="n">main</span> <span class="o">--</span><span class="n">force</span>
</pre></div>
</div>
</li>
</ol>
<p>Once these steps are complete, you can continue with the steps in <a class="reference internal" href="#staging-steps"><span class="std std-ref">Step-by-step Instructions</span></a> to stage your new package recipe using your existing staged-recipes fork.</p>
</section>
</section>
<section id="the-recipe-meta-yaml">
<span id="id2"></span><h2>The recipe meta.yaml<a class="headerlink" href="#the-recipe-meta-yaml" title="Permalink to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file in the recipe directory is at the heart of every conda package.
It defines everything that is required to build and use the package.</p>
<p><code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> is in <a class="reference external" href="https://en.wikipedia.org/wiki/YAML">yaml</a> format, augmented with <a class="reference external" href="http://jinja.pocoo.org/">Jinja</a> templating.</p>
<p>A full reference of the structure and fields of <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file can be found in the <a class="reference external" href="https://conda.io/projects/conda-build/en/stable/resources/define-metadata.html">Defining metadata (meta.yaml)</a> section in the conda-build documentation.</p>
<p>In the following, we highlight particularly important and conda-forge specific information and guidelines, ordered by section in <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code>.</p>
<section id="source">
<h3>Source<a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h3>
<section id="build-from-tarballs-not-repos">
<span id="tarballs-no-repos"></span><h4>Build from tarballs, not repos<a class="headerlink" href="#build-from-tarballs-not-repos" title="Permalink to this heading">¶</a></h4>
<p>Packages should be built from tarballs using the <code class="docutils literal notranslate"><span class="pre">url</span></code> key, not from repositories directly by using e.g. <code class="docutils literal notranslate"><span class="pre">git_url</span></code>.</p>
<p>There are several reasons behind this rule:</p>
<blockquote>
<div><ul class="simple">
<li><p>Repositories are usually larger than tarballs, draining shared CI time and bandwidth</p></li>
<li><p>Repositories are not checksummed.  Thus, using a tarball has a
stronger guarantee that the download that is obtained to build from is
in fact the intended package.</p></li>
<li><p>On some systems, it is possible to not have permission to remove a repo once it is created.</p></li>
</ul>
</div></blockquote>
</section>
<section id="populating-the-hash-field">
<h4>Populating the <code class="docutils literal notranslate"><span class="pre">hash</span></code> field<a class="headerlink" href="#populating-the-hash-field" title="Permalink to this heading">¶</a></h4>
<p>If your package is on <a class="reference external" href="https://pypi.org">PyPi</a>, you can get the sha256 hash from your package’s page
on PyPI; look for the <code class="docutils literal notranslate"><span class="pre">SHA256</span></code> link next to the download link on your package’s
files page, e.g. <code class="docutils literal notranslate"><span class="pre">https://pypi.org/project/&lt;your-project&gt;/#files</span></code>.</p>
<p>You can also generate a hash from the command line on Linux (and Mac if you
install the necessary tools below).</p>
<p>To generate the <code class="docutils literal notranslate"><span class="pre">sha256</span></code> hash: <code class="docutils literal notranslate"><span class="pre">openssl</span> <span class="pre">sha256</span> <span class="pre">your_sdist.tar.gz</span></code></p>
<p>You may need the openssl package, available on conda-forge
<code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">openssl</span> <span class="pre">-c</span> <span class="pre">conda-forge</span></code>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Be sure not to checksum the redirection page. Therefore use, for example,:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">sL</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">username</span><span class="o">/</span><span class="n">reponame</span><span class="o">/</span><span class="n">archive</span><span class="o">/</span><span class="n">vX</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span> <span class="o">|</span> <span class="n">openssl</span> <span class="n">sha256</span>
</pre></div>
</div>
</div>
</section>
<section id="downloading-extra-sources-and-data-files">
<h4>Downloading extra sources and data files<a class="headerlink" href="#downloading-extra-sources-and-data-files" title="Permalink to this heading">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">conda-build</span> <span class="pre">3</span></code> supports multiple sources per recipe. Examples are available <a class="reference external" href="https://docs.conda.io/projects/conda-build/en/stable/resources/define-metadata.html#source-from-multiple-sources">in the conda-build docs</a>.</p>
</section>
</section>
<section id="build">
<h3>Build<a class="headerlink" href="#build" title="Permalink to this heading">¶</a></h3>
<section id="skipping-builds">
<h4>Skipping builds<a class="headerlink" href="#skipping-builds" title="Permalink to this heading">¶</a></h4>
<p>Use the <code class="docutils literal notranslate"><span class="pre">skip</span></code> key in the <code class="docutils literal notranslate"><span class="pre">build</span></code> section along with a selector:</p>
<p>You can e.g. specify not to build …</p>
<blockquote>
<div><ul class="simple">
<li><p>on specific architectures:</p></li>
</ul>
<blockquote>
<div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">build</span><span class="p">:</span>
<span class="w">    </span><span class="nt">skip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">  </span><span class="c1"># [win]</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p>for specific python versions:</p></li>
</ul>
<blockquote>
<div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">build</span><span class="p">:</span>
<span class="w">    </span><span class="nt">skip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">  </span><span class="c1"># [py&lt;35]</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
<p>A full description of selectors is
<a class="reference external" href="https://docs.conda.io/projects/conda-build/en/stable/resources/define-metadata.html#preprocessing-selectors">in the conda docs</a>.</p>
</section>
<section id="optional-bld-bat-and-or-build-sh">
<h4>Optional: <code class="docutils literal notranslate"><span class="pre">bld.bat</span></code> and/or <code class="docutils literal notranslate"><span class="pre">build.sh</span></code><a class="headerlink" href="#optional-bld-bat-and-or-build-sh" title="Permalink to this heading">¶</a></h4>
<p>In many cases, <code class="docutils literal notranslate"><span class="pre">bld.bat</span></code> and/or <code class="docutils literal notranslate"><span class="pre">build.sh</span></code> files are not required.
Pure Python packages almost never need them.</p>
<p>If the build can be executed with one line, you may put this line in the
<code class="docutils literal notranslate"><span class="pre">script</span></code> entry of the <code class="docutils literal notranslate"><span class="pre">build</span></code> section of the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file with:
<code class="docutils literal notranslate"><span class="pre">script:</span> <span class="pre">&quot;{{</span> <span class="pre">PYTHON</span> <span class="pre">}}</span> <span class="pre">-m</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">.</span> <span class="pre">-vv&quot;</span></code>.</p>
<p>Remember to always add <code class="docutils literal notranslate"><span class="pre">pip</span></code> to the host requirements.</p>
</section>
<section id="use-pip">
<span id="id4"></span><h4>Use pip<a class="headerlink" href="#use-pip" title="Permalink to this heading">¶</a></h4>
<p>Normally Python packages should use this line:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">build</span><span class="p">:</span>
<span class="w">  </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">PYTHON</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">-m</span><span class="nv"> </span><span class="s">pip</span><span class="nv"> </span><span class="s">install</span><span class="nv"> </span><span class="s">.</span><span class="nv"> </span><span class="s">-vv&quot;</span>
</pre></div>
</div>
<p>as the installation script in the <code class="docutils literal notranslate"><span class="pre">meta.yml</span></code> file or <code class="docutils literal notranslate"><span class="pre">bld.bat/build.sh</span></code> script files,
while adding <code class="docutils literal notranslate"><span class="pre">pip</span></code> to the host requirements:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">requirements</span><span class="p">:</span>
<span class="w">  </span><span class="nt">host</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pip</span>
</pre></div>
</div>
<p>These options should be used to ensure a clean installation of the package without its
dependencies. This helps make sure that we’re only including this package,
and not accidentally bringing any dependencies along into the conda package.</p>
<p>Usually pure-Python packages only require <code class="docutils literal notranslate"><span class="pre">python</span></code>, <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> and <code class="docutils literal notranslate"><span class="pre">pip</span></code>
as <code class="docutils literal notranslate"><span class="pre">host</span></code> requirements; the real package dependencies are only
<code class="docutils literal notranslate"><span class="pre">run</span></code> requirements.</p>
</section>
</section>
<section id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this heading">¶</a></h3>
<section id="build-host-and-run">
<h4>Build, host and run<a class="headerlink" href="#build-host-and-run" title="Permalink to this heading">¶</a></h4>
<p>Conda-build distinguishes three different kinds of dependencies.
In the following paragraphs, we give a very short overview what packages go where.
For a detailed explanation please refer to the <a class="reference external" href="https://docs.conda.io/projects/conda-build/en/stable/resources/define-metadata.html#requirements-section">conda-build documentation</a>.</p>
<p><strong>Build</strong></p>
<blockquote>
<div><p>Build dependencies are required in the build environment and contain all tools that are not needed on the host of the package.</p>
<p>Following packages are examples of typical <code class="docutils literal notranslate"><span class="pre">build</span></code> dependencies:</p>
<blockquote>
<div><ul class="simple">
<li><p>compilers (see <a class="reference internal" href="knowledge_base.html#dep-compilers"><span class="std std-ref">Compilers</span></a>)</p></li>
<li><p>cmake</p></li>
<li><p>make</p></li>
<li><p>pkg-config</p></li>
<li><p>CDT packages (see <a class="reference internal" href="knowledge_base.html#cdt-packages"><span class="std std-ref">Core Dependency Tree Packages (CDTs)</span></a>)</p></li>
</ul>
</div></blockquote>
</div></blockquote>
<p><strong>Host</strong></p>
<blockquote>
<div><p>Host dependencies are required during build phase, but in contrast to build packages they have to be present on the host.</p>
<p>Following packages are typical examples for <code class="docutils literal notranslate"><span class="pre">host</span></code> dependencies:</p>
<blockquote>
<div><ul class="simple">
<li><p>shared libraries (c/c++)</p></li>
<li><p>python/r libraries that link against c libraries (see e.g. <a class="reference internal" href="knowledge_base.html#linking-numpy"><span class="std std-ref">Building Against NumPy</span></a>)</p></li>
<li><p>python, r-base</p></li>
<li><p>setuptools, pip (see <a class="reference internal" href="#use-pip"><span class="std std-ref">Use pip</span></a>)</p></li>
</ul>
</div></blockquote>
</div></blockquote>
<p><strong>Run</strong></p>
<blockquote>
<div><p>Run dependencies are only required during run time of the package. Run dependencies typically include</p>
<blockquote>
<div><ul class="simple">
<li><p>most python/r libraries</p></li>
</ul>
</div></blockquote>
</div></blockquote>
</section>
<section id="avoid-external-dependencies">
<span id="no-external-deps"></span><h4>Avoid external dependencies<a class="headerlink" href="#avoid-external-dependencies" title="Permalink to this heading">¶</a></h4>
<p>As a general rule: all dependencies have to be packaged by conda-forge as well. This is necessary to assure <a class="reference internal" href="../misc/00_intro.html#term-ABI"><span class="xref std std-term">ABI</span></a> compatibility for all our packages.</p>
<p>There are only a few exceptions to this rule:</p>
<ol class="arabic simple">
<li><p>Some dependencies have to be satisfied with <a class="reference internal" href="../misc/00_intro.html#term-CDT"><span class="xref std std-term">CDT</span></a> packages (see <a class="reference internal" href="knowledge_base.html#cdt-packages"><span class="std std-ref">Core Dependency Tree Packages (CDTs)</span></a>).</p></li>
<li><p>Some packages require root access (e.g. device drivers) that cannot be distributed by conda-forge. These dependencies should be avoided whenever possible.</p></li>
</ol>
</section>
<section id="pinning">
<h4>Pinning<a class="headerlink" href="#pinning" title="Permalink to this heading">¶</a></h4>
<p>Linking shared c/c++ libraries creates dependence on the <a class="reference internal" href="../misc/00_intro.html#term-ABI"><span class="xref std std-term">ABI</span></a> of the library that was used at build time on the package.
The exposed interface changes when previously existing exposed symbols are deleted or modified in a newer version.</p>
<p>It is therefore crucial to ensure that only library versions with a compatible <a class="reference internal" href="../misc/00_intro.html#term-ABI"><span class="xref std std-term">ABI</span></a> are used after linking.</p>
<p>In the best case, the shared library you depend on:</p>
<ul class="simple">
<li><p>defines a pin in the <a class="reference external" href="https://github.com/conda-forge/conda-forge-pinning-feedstock/blob/master/recipe/conda_build_config.yaml">list of globally pinned packages</a></p></li>
<li><p>exports its <a class="reference internal" href="../misc/00_intro.html#term-ABI"><span class="xref std std-term">ABI</span></a> compatible requirements by defining <code class="docutils literal notranslate"><span class="pre">run_exports</span></code> in it’s meta.yaml</p></li>
</ul>
<p>In these cases you do not have to worry about version requirements:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">requirements</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># [...]</span>
<span class="w">  </span><span class="nt">host</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">readline</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libpng</span>
</pre></div>
</div>
<p>In other cases you have to specify <a class="reference internal" href="../misc/00_intro.html#term-ABI"><span class="xref std std-term">ABI</span></a> compatible versions manually.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">requirements</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># [...]</span>
<span class="w">  </span><span class="nt">host</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libawesome 1.1.*</span>
</pre></div>
</div>
<p>For more information on pinning, please refer to <a class="reference internal" href="pinning_deps.html#pinned-deps"><span class="std std-ref">Pinned dependencies</span></a>.</p>
</section>
<section id="constraining-packages-at-runtime">
<h4>Constraining packages at runtime<a class="headerlink" href="#constraining-packages-at-runtime" title="Permalink to this heading">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">run_constrained</span></code> section allows defining restrictions on packages at runtime without depending on the package. It can be used to restrict allowed versions of optional dependencies and defining incompatible packages.</p>
<section id="defining-non-dependency-restrictions">
<h5>Defining non-dependency restrictions<a class="headerlink" href="#defining-non-dependency-restrictions" title="Permalink to this heading">¶</a></h5>
<p>Imagine a package can be used together with version 1 of <code class="docutils literal notranslate"><span class="pre">awesome-software</span></code> when present, but does not strictly depend on it.
Therefore you would like to let the user choose whether he/she would like to use the package with or without <code class="docutils literal notranslate"><span class="pre">awesome-software</span></code>. Let’s assume further that the package is incompatible to version 2 of <code class="docutils literal notranslate"><span class="pre">awesome-software</span></code>.</p>
<p>In this case <code class="docutils literal notranslate"><span class="pre">run_constrained</span></code> can be used to restrict <code class="docutils literal notranslate"><span class="pre">awesome-software</span></code> to version 1.*, if the user chooses to install it:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">requirements</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># [...]</span>
<span class="w">  </span><span class="nt">run_constrained</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">awesome-software 1.*</span>
</pre></div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">run_constrained</span></code> acts as a means to protect users from incompatible versions without introducing an unwanted dependency.</p>
</section>
<section id="defining-conflicts">
<h5>Defining conflicts<a class="headerlink" href="#defining-conflicts" title="Permalink to this heading">¶</a></h5>
<p>Sometimes packages interfere with each other and therefore only one of them can be installed at any time.
In combination with an unsatisfiable version, <code class="docutils literal notranslate"><span class="pre">run_constrained</span></code> can define blockers:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">package</span><span class="p">:</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">awesome-db</span>

<span class="nt">requirements</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># [...]</span>
<span class="w">  </span><span class="nt">run_constrained</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">amazing-db ==9999999999</span>
</pre></div>
</div>
<p>In this example, <code class="docutils literal notranslate"><span class="pre">awesome-db</span></code> cannot be installed together with <code class="docutils literal notranslate"><span class="pre">amazing-db</span></code> as there is no package <code class="docutils literal notranslate"><span class="pre">amazing-db-9999999999</span></code>.</p>
</section>
</section>
</section>
<section id="test">
<span id="testing-in-recipes"></span><h3>Test<a class="headerlink" href="#test" title="Permalink to this heading">¶</a></h3>
<p>All recipes need tests. Here are some tips, tricks, and justifications.
How you should test depends on the type of package (python, c-lib,
command-line tool, … ), and what tests are available for that package.
But every conda package must have at least <em>some</em> tests.</p>
<section id="simple-existence-tests">
<h4>Simple existence tests<a class="headerlink" href="#simple-existence-tests" title="Permalink to this heading">¶</a></h4>
<p>Sometimes defining tests seems to be hard, e.g. due to:</p>
<blockquote>
<div><ul class="simple">
<li><p>tests for the underlying code base may not exist.</p></li>
<li><p>test suites may take too long to run on limited <a class="reference internal" href="../misc/00_intro.html#term-CI"><span class="xref std std-term">CI</span></a> infrastructure.</p></li>
<li><p>tests may take too much bandwidth.</p></li>
</ul>
</div></blockquote>
<p>In these cases, conda-forge may not be able to execute the prescribed test suite.</p>
<p>However, this is no reason for the recipe to not have tests. At the very least,
we want to verify that the package has installed the desired files in the desired
locations. This is called existence testing.</p>
<p>Existence testing can be accomplished in the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> file in the
<code class="docutils literal notranslate"><span class="pre">test/commands</span></code> block.</p>
<p>On posix systems, use the <code class="docutils literal notranslate"><span class="pre">test</span></code> utility and the <code class="docutils literal notranslate"><span class="pre">$PREFIX</span></code> variable.</p>
<p>On Windows, use the <code class="docutils literal notranslate"><span class="pre">exist</span></code> command. See below for an example.</p>
<p>Simple existence testing example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">test</span><span class="p">:</span>
<span class="w">  </span><span class="nt">commands</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test -f $PREFIX/lib/libboost_log$SHLIB_EXT</span><span class="w">  </span><span class="c1"># [unix]</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">if not exist %LIBRARY_LIB%\\boost_log-vc140-mt.lib exit 1</span><span class="w">  </span><span class="c1"># [win]</span>
</pre></div>
</div>
</section>
<section id="testing-python-packages">
<h4>Testing python packages<a class="headerlink" href="#testing-python-packages" title="Permalink to this heading">¶</a></h4>
<p>For the best information about testing, see the conda build docs
<a class="reference external" href="https://docs.conda.io/projects/conda-build/en/stable/resources/define-metadata.html#test-section">test section.</a></p>
<section id="testing-importing">
<h5>Testing importing<a class="headerlink" href="#testing-importing" title="Permalink to this heading">¶</a></h5>
<p>The minimal test of a python package should make sure that the package
can be successfully imported. This can be accomplished with this
stanza in the <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">test</span><span class="p">:</span>
<span class="w">  </span><span class="nt">imports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">package_name</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">package_name</span></code> is the name imported by python;
not necessarily the name of the conda package (they are sometimes different).</p>
<p>Testing for an import will catch the bulk of the packaging errors, generally
including the presence of dependencies. However, it does not assure that the
package works correctly. In particular, it doesn’t test if it works
correctly with the versions of dependencies used. In some cases, the top level
import name does not contain any executable code (e.g. a package with an empty
<code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>, or without any direct imports). This test would always pass!
In these cases, it helps to add more imports explicitly targetting modules
that do contain executable code (e.g. <code class="docutils literal notranslate"><span class="pre">package_name.core</span></code>).</p>
<p>It is good to run some other tests of the code itself (the test suite) if possible.</p>
</section>
<section id="pip-check">
<span id="id5"></span><h5>pip check<a class="headerlink" href="#pip-check" title="Permalink to this heading">¶</a></h5>
<p>For PyPI packages, we strongly recommend including <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">check</span></code> as part of the <code class="docutils literal notranslate"><span class="pre">test.commands</span></code> section:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">test</span><span class="p">:</span>
<span class="w">  </span><span class="nt">commands</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pip check</span>
</pre></div>
</div>
<p>This command will check if all the dependencies specified in the Python
metadata are satisfied.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">check</span></code> can sometimes fail due to metadata discrepancies between
PyPI and conda-forge (e.g. same package with different names). In these
cases, the reviewer must evaluate whether the error was a false negative.
Tip: use <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">list</span></code> to show what <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">check</span></code> “sees”.</p>
</div>
</section>
</section>
<section id="running-unit-tests">
<h4>Running unit tests<a class="headerlink" href="#running-unit-tests" title="Permalink to this heading">¶</a></h4>
<p>The trick here is that there are multiple ways to run unit tests in Python,
including nose, pytest, etc.</p>
<p>Also, some packages install the tests with the package, and thus they can be
run in place, while others keep the tests with the source code, and thus can
not be run straight from an installed package.</p>
<section id="test-requirements">
<h5>Test requirements<a class="headerlink" href="#test-requirements" title="Permalink to this heading">¶</a></h5>
<p>Sometimes there are packages required to run the tests that are not required
to simply use the package. This is usually a test-running framework, such as
nose or pytest. You can ensure that it is included by adding it to requirements
in the test stanza:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">test</span><span class="p">:</span>
<span class="w">  </span><span class="nt">imports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">package_name</span>
<span class="nn">...</span>
<span class="w">  </span><span class="nt">requires</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytest</span>
</pre></div>
</div>
</section>
<section id="copying-test-files">
<h5>Copying test files<a class="headerlink" href="#copying-test-files" title="Permalink to this heading">¶</a></h5>
<p>Often test files are not installed alongside packages. Conda creates a fresh
working copy to execute the test stage of build recipes, which don’t contain
the files of source package.</p>
<p>You can include files required for testing with the <code class="docutils literal notranslate"><span class="pre">source_files</span></code> section:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">test</span><span class="p">:</span>
<span class="w">  </span><span class="nt">imports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">package_name</span>
<span class="w">  </span><span class="nt">requires</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytest</span>
<span class="w">  </span><span class="nt">source_files</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tests</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test_pkg_integration.py</span>
<span class="w">  </span><span class="nt">commands</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytest tests test_pkg_integration.py</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">source_files</span></code> section works for files and directories.</p>
</section>
<section id="built-in-tests">
<h5>Built-in tests<a class="headerlink" href="#built-in-tests" title="Permalink to this heading">¶</a></h5>
<p>Some packages have testing built-in. In this case, you can put a test command
directly in the test stanza:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">test</span><span class="p">:</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">commands</span><span class="p p-Indicator">:</span>
<span class="w">     </span><span class="l l-Scalar l-Scalar-Plain">python -c &quot;import package_name; package_name.tests.runall()&quot;</span>
</pre></div>
</div>
<p>Alternatively, you can add a file called <code class="docutils literal notranslate"><span class="pre">run_test.py</span></code> in the recipe that
will be run at test time. This allows an arbitrarily complicated test script.</p>
</section>
<section id="pytest-tests">
<h5>pytest tests<a class="headerlink" href="#pytest-tests" title="Permalink to this heading">¶</a></h5>
<p>If the tests are installed with the package, pytest can find and run them
for you with the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">:</span>
  <span class="n">requires</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">pytest</span>
  <span class="n">commands</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">pytest</span> <span class="o">--</span><span class="n">pyargs</span> <span class="n">package_name</span>
</pre></div>
</div>
</section>
</section>
<section id="command-line-utilities">
<h4>Command Line Utilities<a class="headerlink" href="#command-line-utilities" title="Permalink to this heading">¶</a></h4>
<p>If a python package installs command line utilities, you probably want to test that
they were properly installed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">:</span>
  <span class="n">commands</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">util_1</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<p>If the utility actually has a test mode, great. Otherwise simply invoking
<code class="docutils literal notranslate"><span class="pre">--help</span></code> or <code class="docutils literal notranslate"><span class="pre">--version</span></code> or something will at least test that it is
installed and can run.</p>
</section>
<section id="tests-outside-of-the-package">
<h4>Tests outside of the package<a class="headerlink" href="#tests-outside-of-the-package" title="Permalink to this heading">¶</a></h4>
<p>Note that conda-build runs the tests in an isolated environment after installing
the package – thus, at this point it does not have access to the original source
tarball.  This is to ensure that the test environment is as close as possible to
what an end-user will see.</p>
<p>This makes it very hard to run tests that are not installed with the package.</p>
</section>
<section id="running-tests-locally-for-staged-recipes">
<span id="staging-test-locally"></span><h4>Running tests locally for staged recipes<a class="headerlink" href="#running-tests-locally-for-staged-recipes" title="Permalink to this heading">¶</a></h4>
<p>If you want to run and build packages in the staged-recipes repository locally,
go to the root repository directory and run the
<code class="docutils literal notranslate"><span class="pre">build-locally.py</span></code> script (you need Python 3). And then you could follow the prompt to select the variant you’d like to build. This requires that you have Docker
installed on your machine if you are building a package for Linux.
For MacOS, it will prompt you to select a location for the SDK (e.g. <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">OSX_SDK_DIR=/opt</span></code>) to be downloaded.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~/staged-recipes
$<span class="w"> </span>python<span class="w"> </span>build-locally.py
</pre></div>
</div>
<p>If you know which image you want to build, you can specify it as an argument to the script.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~/staged-recipes
$<span class="w"> </span>python<span class="w"> </span>build-locally.py<span class="w"> </span>&lt;VARIANT&gt;
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">&lt;VARIANT&gt;</span></code> is one of the file names in the <code class="docutils literal notranslate"><span class="pre">.ci_support/</span></code> directory, e.g. <code class="docutils literal notranslate"><span class="pre">linux64</span></code>, <code class="docutils literal notranslate"><span class="pre">osx64</span></code>, and <code class="docutils literal notranslate"><span class="pre">linux64_cuda102</span></code>.</p>
</section>
</section>
<section id="about">
<h3>About<a class="headerlink" href="#about" title="Permalink to this heading">¶</a></h3>
<section id="packaging-the-license-manually">
<h4>Packaging the license manually<a class="headerlink" href="#packaging-the-license-manually" title="Permalink to this heading">¶</a></h4>
<p>Sometimes upstream maintainers do not include a license file in their tarball despite being demanded by the license.</p>
<p>If this is the case, you can add the license to the <code class="docutils literal notranslate"><span class="pre">recipe</span></code> directory (here named <code class="docutils literal notranslate"><span class="pre">LICENSE.txt</span></code>)  and reference it inside the meta.yaml:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">about</span><span class="p">:</span>
<span class="w">  </span><span class="nt">license_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LICENSE.txt</span>
</pre></div>
</div>
<p>In this case, please also notify the upstream developers that the license file is missing.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The license should only be shipped along with the recipe if there is no license file in the downloaded archive.
If there is a license file in the archive, please set <code class="docutils literal notranslate"><span class="pre">license_file</span></code> to the path of the license file in the archive.</p>
</div>
</section>
<section id="spdx-identifiers-and-expressions">
<span id="spdx"></span><h4>SPDX Identifiers and Expressions<a class="headerlink" href="#spdx-identifiers-and-expressions" title="Permalink to this heading">¶</a></h4>
<p>For the <code class="docutils literal notranslate"><span class="pre">about:</span> <span class="pre">license</span></code> entry in the recipe <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code>, using a SPDX identifier or expression is recommended.</p>
<p>See <a class="reference external" href="https://spdx.org/licenses/">SPDX license identifiers</a> for the licenses.
See <a class="reference external" href="https://spdx.org/licenses/exceptions-index.html">SPDX license exceptions</a> for license exceptions.
See <a class="reference external" href="https://spdx.org/spdx-specification-21-web-version">SPDX specification</a> Appendix IV
for the specification on expressions. Some examples of these are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Apache-2.0
Apache-2.0 WITH LLVM-exception
BSD-3-Clause
BSD-3-Clause OR MIT
GPL-2.0-or-later
LGPL-2.0-only OR GPL-2.0-only
LicenseRef-HDF5
MIT
MIT AND BSD-2-Clause
PSF-2.0
Unlicense
</pre></div>
</div>
</section>
<section id="licenses-of-included-dependencies">
<span id="third-party-package-licenses"></span><h4>Licenses of included dependencies<a class="headerlink" href="#licenses-of-included-dependencies" title="Permalink to this heading">¶</a></h4>
<p>For some languages (Go, rust, etc.), the current policy is to include all dependencies and their dependencies in the package.
This presents a problem when packaging the license files as each dependency needs to have its license file included in the recipe.</p>
<p>For some languages, the community provides tools which can automate this process, enabling the automatic inclusion of all needed license files.</p>
<ul>
<li><p><strong>Rust</strong></p>
<p><a class="reference external" href="https://github.com/sstadick/cargo-bundle-licenses">cargo-bundle-licenses</a> can be included in the build process of a package and will automatically collect and add the license files of all dependencies of a package.</p>
<p>For a detailed description, please visit the project page but a short example can be found below.</p>
<p>First, include the collection of licenses as a step of the build process.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">build</span><span class="p">:</span>
<span class="w">  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">  </span><span class="nt">script</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cargo-bundle-licenses --format yaml --output THIRDPARTY.yml</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build_command_goes_here</span>
</pre></div>
</div>
<p>Then, include the tool as a build time dependency.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">requirements</span><span class="p">:</span>
<span class="w">  </span><span class="nt">build</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cargo-bundle-licenses</span>
</pre></div>
</div>
<p>Finally, make sure that the generated file is included in the recipe.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">about</span><span class="p">:</span>
<span class="w">  </span><span class="nt">license_file</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">THIRDPARTY.yml</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">package_license.txt</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>We are not lawyers and cannot guarantee that the above advice is correct or that the tools are able to find all license files.
Additionally, we are unable to accept any responsibility or liability.
It is always your responsibility to double-check that all licenses are included and verify that any generated output is correct.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The correct and automated packaging of dependency licenses is an ongoing discussion. Please feel free to add your thoughs to <a class="reference external" href="https://github.com/conda-forge/conda-forge.github.io/issues/1052">this</a> discussion.</p>
</div>
</section>
</section>
<section id="extra">
<h3>Extra<a class="headerlink" href="#extra" title="Permalink to this heading">¶</a></h3>
<section id="recipe-maintainer">
<span id="id6"></span><h4>Recipe Maintainer<a class="headerlink" href="#recipe-maintainer" title="Permalink to this heading">¶</a></h4>
<p>A maintainer is an individual who is responsible for maintaining and updating one or more feedstock repositories and packages as well as their future versions. They have push access to the feedstock repositories of only the packages they maintain and can merge pull requests into it.</p>
<p>Contributing a recipe for package makes you the <code class="docutils literal notranslate"><span class="pre">maintainer</span></code> of that package automatically.
See <a class="reference external" href="https://conda-forge.org/docs/maintainer/adding_pkgs.html#maintainer-role">Maintainers Role</a> and <a class="reference external" href="https://conda-forge.org/docs/maintainer/updating_pkgs.html#maintaining-packages">Maintaining Packages</a> to learn more about what are the things that maintainers do.
If you wish to be a maintainer of a certain package, you should contact current maintainers and open an issue in that package’s feedstock with the following command:</p>
<p><code class="docutils literal notranslate"><span class="pre">&#64;conda-forge-admin,</span> <span class="pre">please</span> <span class="pre">add</span> <span class="pre">user</span> <span class="pre">&#64;username</span></code></p>
<p>where username is the GitHub username of the new maintainer to be added. Please refer to <a class="reference external" href="https://conda-forge.org/docs/orga/guidelines.html#becoming-a-maintainer">Becoming a maintainer</a> and <a class="reference external" href="https://conda-forge.org/docs/maintainer/updating_pkgs.html#updating-the-maintainer-list">Updating the maintainer</a> for detailed instructions.</p>
</section>
<section id="feedstock-name">
<span id="id7"></span><h4>Feedstock name<a class="headerlink" href="#feedstock-name" title="Permalink to this heading">¶</a></h4>
<p>If you want the name of the feedstock to be different from the package name in the staged-recipes, you can use the <code class="docutils literal notranslate"><span class="pre">feedstock-name</span></code> directive in the recipe of that package, like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">extra</span><span class="p">:</span>
<span class="w">  </span><span class="nt">feedstock-name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;name&gt;</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">&lt;name&gt;</span></code> is the name you would want for the feedstock.
If not specified, the name will be taken from the top-level <code class="docutils literal notranslate"><span class="pre">name</span></code> field in <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code>.</p>
</section>
</section>
</section>
<section id="miscellaneous">
<h2>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this heading">¶</a></h2>
<section id="activate-scripts">
<span id="id8"></span><h3>Activate scripts<a class="headerlink" href="#activate-scripts" title="Permalink to this heading">¶</a></h3>
<p>Recipes are allowed to have activate scripts, which will be <code class="docutils literal notranslate"><span class="pre">source</span></code>d or
<code class="docutils literal notranslate"><span class="pre">call</span></code>ed when the environment is activated. It is generally recommended to avoid using
activate scripts when another option is possible because people do not always
activate environments the expected way and these packages may then misbehave.</p>
<p>When using them in a recipe, feel free to name them <code class="docutils literal notranslate"><span class="pre">activate.bat</span></code>,
<code class="docutils literal notranslate"><span class="pre">activate.sh</span></code>, <code class="docutils literal notranslate"><span class="pre">deactivate.bat</span></code>, and <code class="docutils literal notranslate"><span class="pre">deactivate.sh</span></code> in the recipe. The
installed scripts are recommended to be prefixed by the package name and a
separating <code class="docutils literal notranslate"><span class="pre">-</span></code>. Below is some sample code for Unix and Windows that will make
this install process easier. Please feel free to lift it.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">build.sh</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Copy the [de]activate scripts to $PREFIX/etc/conda/[de]activate.d.</span>
<span class="c1"># This will allow them to be run on environment activation.</span>
<span class="k">for</span><span class="w"> </span>CHANGE<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;activate&quot;</span><span class="w"> </span><span class="s2">&quot;deactivate&quot;</span>
<span class="k">do</span>
<span class="w">    </span>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PREFIX</span><span class="si">}</span><span class="s2">/etc/conda/</span><span class="si">${</span><span class="nv">CHANGE</span><span class="si">}</span><span class="s2">.d&quot;</span>
<span class="w">    </span>cp<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">RECIPE_DIR</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">CHANGE</span><span class="si">}</span><span class="s2">.sh&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PREFIX</span><span class="si">}</span><span class="s2">/etc/conda/</span><span class="si">${</span><span class="nv">CHANGE</span><span class="si">}</span><span class="s2">.d/</span><span class="si">${</span><span class="nv">PKG_NAME</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">CHANGE</span><span class="si">}</span><span class="s2">.sh&quot;</span>
<span class="k">done</span>
</pre></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">build.bat</span></code>:</p>
<div class="highlight-batch notranslate"><div class="highlight"><pre><span></span><span class="k">setlocal</span> EnableDelayedExpansion

<span class="p">:</span><span class="c1">: Copy the [de]activate scripts to %PREFIX%\etc\conda\[de]activate.d.</span>
<span class="p">:</span><span class="c1">: This will allow them to be run on environment activation.</span>
<span class="k">for</span> <span class="se">%%</span>F <span class="k">in</span> <span class="p">(</span>activate deactivate<span class="p">)</span> <span class="k">DO</span> <span class="p">(</span>
    <span class="k">if</span> <span class="k">not</span> <span class="k">exist</span> <span class="nv">%PREFIX%</span>\etc\conda\<span class="se">%%</span>F.d <span class="k">mkdir</span> <span class="nv">%PREFIX%</span>\etc\conda\<span class="se">%%</span>F.d
    <span class="k">copy</span> <span class="nv">%RECIPE_DIR%</span>\<span class="se">%%</span>F.bat <span class="nv">%PREFIX%</span>\etc\conda\<span class="se">%%</span>F.d\<span class="nv">%PKG_NAME%</span>_<span class="se">%%</span>F.bat
    <span class="p">:</span><span class="c1">: Copy unix shell activation scripts, needed by Windows Bash users</span>
    <span class="k">copy</span> <span class="nv">%RECIPE_DIR%</span>\<span class="se">%%</span>F.sh <span class="nv">%PREFIX%</span>\etc\conda\<span class="se">%%</span>F.d\<span class="nv">%PKG_NAME%</span>_<span class="se">%%</span>F.sh
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="jinja-templating">
<h3>Jinja templating<a class="headerlink" href="#jinja-templating" title="Permalink to this heading">¶</a></h3>
<p>The recipe <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> can contain expressions that are evaluated during build time.
These expressions are written in <a class="reference external" href="http://jinja.pocoo.org/">Jinja</a> syntax.</p>
<p>Jinja expressions serve following purposes in the meta.yaml:</p>
<ul>
<li><p>They allow defining variables to avoid code duplication. Using a variable for the <code class="docutils literal notranslate"><span class="pre">version</span></code> allows changing the version only once with every update.</p>
<div class="highlight-yaml+jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">set</span> <span class="nv">version</span> <span class="o">=</span> <span class="s2">&quot;3.7.3&quot;</span> <span class="cp">%}</span>

<span class="nt">package</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python</span>
<span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="cp">{{</span> <span class="nv">version</span> <span class="cp">}}</span>

<span class="nt">source</span><span class="p">:</span>
<span class="w">  </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://www.python.org/ftp/python/</span><span class="cp">{{</span> <span class="nv">version</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">/Python-</span><span class="cp">{{</span> <span class="nv">version</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">.tar.xz</span>
<span class="w">  </span><span class="nt">sha256</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">da60b54064d4cfcd9c26576f6df2690e62085123826cff2e667e72a91952d318</span>
</pre></div>
</div>
</li>
<li><p>They can call <a class="reference external" href="https://docs.conda.io/projects/conda-build/en/stable/resources/define-metadata.html#conda-build-specific-jinja2-functions">conda-build functions</a> for automatic code generation. Examples are the compilers, cdt packages or the <code class="docutils literal notranslate"><span class="pre">pin_compatible</span></code> function.</p>
<div class="highlight-yaml+jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">requirements</span><span class="p">:</span>
<span class="w">  </span><span class="nt">build</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="cp">{{</span> <span class="nv">compiler</span><span class="o">(</span><span class="s1">&#39;c&#39;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="cp">{{</span> <span class="nv">compiler</span><span class="o">(</span><span class="s1">&#39;cxx&#39;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="cp">{{</span> <span class="nv">cdt</span><span class="o">(</span><span class="s1">&#39;xorg-x11-proto-devel&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="w">  </span><span class="c1"># [linux]</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="cp">{{</span> <span class="nv">cdt</span><span class="o">(</span><span class="s1">&#39;libx11-devel&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="w">          </span><span class="c1"># [linux]</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">requirements</span><span class="p">:</span>
<span class="w">  </span><span class="nt">build</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{{</span><span class="w"> </span><span class="nv">compiler(&#39;c&#39;)</span><span class="w"> </span><span class="p p-Indicator">}}</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{{</span><span class="w"> </span><span class="nv">compiler(&#39;cxx&#39;)</span><span class="w"> </span><span class="p p-Indicator">}}</span>
<span class="w">  </span><span class="nt">host</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">numpy</span>
<span class="w">  </span><span class="nt">run</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{{</span><span class="w"> </span><span class="nv">pin_compatible(&#39;numpy&#39;)</span><span class="w"> </span><span class="p p-Indicator">}}</span>
</pre></div>
</div>
</li>
</ul>
<p>For more information please refer to the <a class="reference external" href="https://docs.conda.io/projects/conda-build/en/stable/resources/define-metadata.html#templating-with-jinja">Templating with Jinja</a> section in the conda-build docs.</p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="../index.html">Overview</a></h3>
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user/00_intro.html">User Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="00_intro.html">Maintainer Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="infrastructure.html">Infrastructure</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Contributing packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-staging-process">The staging process</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#generating-the-recipe">Generating the recipe</a></li>
<li class="toctree-l4"><a class="reference internal" href="#step-by-step-instructions">Step-by-step Instructions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#checklist">Checklist</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#feedback-and-revision">Feedback and revision</a></li>
<li class="toctree-l4"><a class="reference internal" href="#post-staging-process">Post staging process</a></li>
<li class="toctree-l4"><a class="reference internal" href="#feedstock-repository-structure">Feedstock repository structure</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#recipe">recipe</a></li>
<li class="toctree-l5"><a class="reference internal" href="#license-txt">LICENSE.txt</a></li>
<li class="toctree-l5"><a class="reference internal" href="#ci-files">CI-files</a></li>
<li class="toctree-l5"><a class="reference internal" href="#conda-forge-yml">conda-forge.yml</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#maintainer-role">Maintainer role</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adding-multiple-packages-at-once">Adding multiple packages at once</a></li>
<li class="toctree-l4"><a class="reference internal" href="#synchronizing-fork-for-future-use">Synchronizing fork for future use</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-recipe-meta-yaml">The recipe meta.yaml</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#source">Source</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#build-from-tarballs-not-repos">Build from tarballs, not repos</a></li>
<li class="toctree-l5"><a class="reference internal" href="#populating-the-hash-field">Populating the <code class="docutils literal notranslate"><span class="pre">hash</span></code> field</a></li>
<li class="toctree-l5"><a class="reference internal" href="#downloading-extra-sources-and-data-files">Downloading extra sources and data files</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#build">Build</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#skipping-builds">Skipping builds</a></li>
<li class="toctree-l5"><a class="reference internal" href="#optional-bld-bat-and-or-build-sh">Optional: <code class="docutils literal notranslate"><span class="pre">bld.bat</span></code> and/or <code class="docutils literal notranslate"><span class="pre">build.sh</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#use-pip">Use pip</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#requirements">Requirements</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#build-host-and-run">Build, host and run</a></li>
<li class="toctree-l5"><a class="reference internal" href="#avoid-external-dependencies">Avoid external dependencies</a></li>
<li class="toctree-l5"><a class="reference internal" href="#pinning">Pinning</a></li>
<li class="toctree-l5"><a class="reference internal" href="#constraining-packages-at-runtime">Constraining packages at runtime</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#defining-non-dependency-restrictions">Defining non-dependency restrictions</a></li>
<li class="toctree-l6"><a class="reference internal" href="#defining-conflicts">Defining conflicts</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#test">Test</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#simple-existence-tests">Simple existence tests</a></li>
<li class="toctree-l5"><a class="reference internal" href="#testing-python-packages">Testing python packages</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#testing-importing">Testing importing</a></li>
<li class="toctree-l6"><a class="reference internal" href="#pip-check">pip check</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#running-unit-tests">Running unit tests</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#test-requirements">Test requirements</a></li>
<li class="toctree-l6"><a class="reference internal" href="#copying-test-files">Copying test files</a></li>
<li class="toctree-l6"><a class="reference internal" href="#built-in-tests">Built-in tests</a></li>
<li class="toctree-l6"><a class="reference internal" href="#pytest-tests">pytest tests</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#command-line-utilities">Command Line Utilities</a></li>
<li class="toctree-l5"><a class="reference internal" href="#tests-outside-of-the-package">Tests outside of the package</a></li>
<li class="toctree-l5"><a class="reference internal" href="#running-tests-locally-for-staged-recipes">Running tests locally for staged recipes</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#about">About</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#packaging-the-license-manually">Packaging the license manually</a></li>
<li class="toctree-l5"><a class="reference internal" href="#spdx-identifiers-and-expressions">SPDX Identifiers and Expressions</a></li>
<li class="toctree-l5"><a class="reference internal" href="#licenses-of-included-dependencies">Licenses of included dependencies</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#extra">Extra</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#recipe-maintainer">Recipe Maintainer</a></li>
<li class="toctree-l5"><a class="reference internal" href="#feedstock-name">Feedstock name</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#miscellaneous">Miscellaneous</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#activate-scripts">Activate scripts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#jinja-templating">Jinja templating</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="updating_pkgs.html">Maintaining packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="pinning_deps.html">Pinned dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="conda_forge_yml.html">Configuring conda-forge.yml</a></li>
<li class="toctree-l2"><a class="reference internal" href="knowledge_base.html">Knowledge Base</a></li>
<li class="toctree-l2"><a class="reference internal" href="maintainer_faq.html">FAQ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../orga/00_intro.html">Organisation Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/00_intro.html">Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contracting/00_intro.html">Contracting Information</a></li>
</ul>

  </div>
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="infrastructure.html"
                          title="Previous page">&larr; Infrastructure</a></p>
  </div>
  <div class="sphinxnext">
    <h4>Next page</h4>
    <p class="topless"><a href="updating_pkgs.html"
                          title="Next page">&rarr; Maintaining packages</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/maintainer/adding_pkgs.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="updating_pkgs.html" title="Maintaining packages"
             >next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="infrastructure.html" title="Infrastructure"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">conda-forge 2023.06.22 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="00_intro.html" >Maintainer Documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Contributing packages</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2023, conda-forge.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>